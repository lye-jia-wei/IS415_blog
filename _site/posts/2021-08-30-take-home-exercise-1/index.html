<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ad0000; } /* Alert */
code span.an { color: #5e5e5e; } /* Annotation */
code span.at { color: #20794d; } /* Attribute */
code span.bn { color: #ad0000; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007ba5; } /* ControlFlow */
code span.ch { color: #20794d; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #5e5e5e; } /* Comment */
code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
code span.dt { color: #ad0000; } /* DataType */
code span.dv { color: #ad0000; } /* DecVal */
code span.er { color: #ad0000; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #ad0000; } /* Float */
code span.fu { color: #4758ab; } /* Function */
code span.im { } /* Import */
code span.in { color: #5e5e5e; } /* Information */
code span.kw { color: #007ba5; } /* Keyword */
code span.op { color: #5e5e5e; } /* Operator */
code span.ot { color: #007ba5; } /* Other */
code span.pp { color: #ad0000; } /* Preprocessor */
code span.sc { color: #20794d; } /* SpecialChar */
code span.ss { color: #20794d; } /* SpecialString */
code span.st { color: #20794d; } /* String */
code span.va { color: #111111; } /* Variable */
code span.vs { color: #20794d; } /* VerbatimString */
code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
<title>IS415 Blog: Take-home Exercise 1</title>

<meta property="description" itemprop="description" content="Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"/>


<!--  https://schema.org/Article -->
<meta property="article:published" itemprop="datePublished" content="2021-08-30"/>
<meta property="article:created" itemprop="dateCreated" content="2021-08-30"/>
<meta name="article:author" content="Lye Jia Wei"/>

<!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
<meta property="og:title" content="IS415 Blog: Take-home Exercise 1"/>
<meta property="og:type" content="article"/>
<meta property="og:description" content="Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:site_name" content="IS415 Blog"/>

<!--  https://dev.twitter.com/cards/types/summary -->
<meta property="twitter:card" content="summary"/>
<meta property="twitter:title" content="IS415 Blog: Take-home Exercise 1"/>
<meta property="twitter:description" content="Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"/>

<!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

<script type="text/json" id="radix-rmarkdown-metadata">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["Take-home Exercise 1"]},{"type":"character","attributes":{},"value":["Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","url"]}},"value":[{"type":"character","attributes":{},"value":["Lye Jia Wei"]},{"type":"character","attributes":{},"value":["https://lye-jia-wei.github.io/"]}]}]},{"type":"character","attributes":{},"value":["08-30-2021"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["toc","toc_depth","toc_float","self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[true]},{"type":"integer","attributes":{},"value":[2]},{"type":"logical","attributes":{},"value":[true]},{"type":"logical","attributes":{},"value":[false]}]}]}]}
</script>
<!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["AnimatedMap/Covd_Death_Animation.gif","AnimatedMap/Covid_Case_Animation.gif","data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 April 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 April 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 Juni 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 Juni 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 November 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (30 September 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Agustus 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Desember 2020 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Juli 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Juli 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Maret 2020 Pukul 08.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Maret 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 MEI 2020 Pukul 09.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Mei 2021 Pukul 10.00).xlsx","data/aspatial/Standar Kelurahan Data Corona (31 Oktober 2020 Pukul 10.00).xlsx","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.cpg","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.dbf","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.prj","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.sbn","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.sbx","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shp","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shp.xml","data/geospatial/BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA.shx","data/rds/Covid_DF.rds","data/rds/DKI_Jakarta.rds","take-home-exercise-1_files/anchor-4.2.2/anchor.min.js","take-home-exercise-1_files/bowser-1.9.3/bowser.min.js","take-home-exercise-1_files/distill-2.2.21/template.v2.js","take-home-exercise-1_files/figure-html5/unnamed-chunk-13-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-28-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-29-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-30-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-31-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-32-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-34-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-35-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-37-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-38-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-39-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-42-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-43-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-44-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-45-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-47-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-48-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-49-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-50-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-51-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-52-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-53-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-54-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-56-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-57-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-58-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-59-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-60-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-61-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-62-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-63-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-64-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-65-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-66-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-67-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-68-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-69-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-7-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-70-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-71-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-72-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-73-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-75-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-76-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-77-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-78-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-79-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-8-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-80-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-81-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-82-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-83-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-84-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-85-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-86-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-88-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-89-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-9-1.png","take-home-exercise-1_files/figure-html5/unnamed-chunk-91-1.png","take-home-exercise-1_files/header-attrs-2.10/header-attrs.js","take-home-exercise-1_files/htmlwidgets-1.5.3/htmlwidgets.js","take-home-exercise-1_files/jquery-1.11.3/jquery.min.js","take-home-exercise-1_files/jquery-1.12.4/jquery.min.js","take-home-exercise-1_files/leaflet-1.3.1/images/layers-2x.png","take-home-exercise-1_files/leaflet-1.3.1/images/layers.png","take-home-exercise-1_files/leaflet-1.3.1/images/marker-icon-2x.png","take-home-exercise-1_files/leaflet-1.3.1/images/marker-icon.png","take-home-exercise-1_files/leaflet-1.3.1/images/marker-shadow.png","take-home-exercise-1_files/leaflet-1.3.1/leaflet.css","take-home-exercise-1_files/leaflet-1.3.1/leaflet.js","take-home-exercise-1_files/leaflet-binding-2.0.4.1/leaflet.js","take-home-exercise-1_files/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js","take-home-exercise-1_files/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js","take-home-exercise-1_files/leafletfix-1.0.0/leafletfix.css","take-home-exercise-1_files/popper-2.6.0/popper.min.js","take-home-exercise-1_files/proj4-2.6.2/proj4.min.js","take-home-exercise-1_files/Proj4Leaflet-1.0.1/proj4leaflet.js","take-home-exercise-1_files/rstudio_leaflet-1.3.1/images/1px.png","take-home-exercise-1_files/rstudio_leaflet-1.3.1/rstudio_leaflet.css","take-home-exercise-1_files/tippy-6.2.7/tippy-bundle.umd.min.js","take-home-exercise-1_files/tippy-6.2.7/tippy-light-border.css","take-home-exercise-1_files/tippy-6.2.7/tippy.css","take-home-exercise-1_files/tippy-6.2.7/tippy.umd.min.js","take-home-exercise-1_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
<meta name="distill:offset" content="../.."/>

<script type="application/javascript">

  window.headroom_prevent_pin = false;

  window.document.addEventListener("DOMContentLoaded", function (event) {

    // initialize headroom for banner
    var header = $('header').get(0);
    var headerHeight = header.offsetHeight;
    var headroom = new Headroom(header, {
      tolerance: 5,
      onPin : function() {
        if (window.headroom_prevent_pin) {
          window.headroom_prevent_pin = false;
          headroom.unpin();
        }
      }
    });
    headroom.init();
    if(window.location.hash)
      headroom.unpin();
    $(header).addClass('headroom--transition');

    // offset scroll location for banner on hash change
    // (see: https://github.com/WickyNilliams/headroom.js/issues/38)
    window.addEventListener("hashchange", function(event) {
      window.scrollTo(0, window.pageYOffset - (headerHeight + 25));
    });

    // responsive menu
    $('.distill-site-header').each(function(i, val) {
      var topnav = $(this);
      var toggle = topnav.find('.nav-toggle');
      toggle.on('click', function() {
        topnav.toggleClass('responsive');
      });
    });

    // nav dropdowns
    $('.nav-dropbtn').click(function(e) {
      $(this).next('.nav-dropdown-content').toggleClass('nav-dropdown-active');
      $(this).parent().siblings('.nav-dropdown')
         .children('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $("body").click(function(e){
      $('.nav-dropdown-content').removeClass('nav-dropdown-active');
    });
    $(".nav-dropdown").click(function(e){
      e.stopPropagation();
    });
  });
</script>

<style type="text/css">

/* Theme (user-documented overrideables for nav appearance) */

.distill-site-nav {
  color: rgba(255, 255, 255, 0.8);
  background-color: #0F2E3D;
  font-size: 15px;
  font-weight: 300;
}

.distill-site-nav a {
  color: inherit;
  text-decoration: none;
}

.distill-site-nav a:hover {
  color: white;
}

@media print {
  .distill-site-nav {
    display: none;
  }
}

.distill-site-header {

}

.distill-site-footer {

}


/* Site Header */

.distill-site-header {
  width: 100%;
  box-sizing: border-box;
  z-index: 3;
}

.distill-site-header .nav-left {
  display: inline-block;
  margin-left: 8px;
}

@media screen and (max-width: 768px) {
  .distill-site-header .nav-left {
    margin-left: 0;
  }
}


.distill-site-header .nav-right {
  float: right;
  margin-right: 8px;
}

.distill-site-header a,
.distill-site-header .title {
  display: inline-block;
  text-align: center;
  padding: 14px 10px 14px 10px;
}

.distill-site-header .title {
  font-size: 18px;
  min-width: 150px;
}

.distill-site-header .logo {
  padding: 0;
}

.distill-site-header .logo img {
  display: none;
  max-height: 20px;
  width: auto;
  margin-bottom: -4px;
}

.distill-site-header .nav-image img {
  max-height: 18px;
  width: auto;
  display: inline-block;
  margin-bottom: -3px;
}



@media screen and (min-width: 1000px) {
  .distill-site-header .logo img {
    display: inline-block;
  }
  .distill-site-header .nav-left {
    margin-left: 20px;
  }
  .distill-site-header .nav-right {
    margin-right: 20px;
  }
  .distill-site-header .title {
    padding-left: 12px;
  }
}


.distill-site-header .nav-toggle {
  display: none;
}

.nav-dropdown {
  display: inline-block;
  position: relative;
}

.nav-dropdown .nav-dropbtn {
  border: none;
  outline: none;
  color: rgba(255, 255, 255, 0.8);
  padding: 16px 10px;
  background-color: transparent;
  font-family: inherit;
  font-size: inherit;
  font-weight: inherit;
  margin: 0;
  margin-top: 1px;
  z-index: 2;
}

.nav-dropdown-content {
  display: none;
  position: absolute;
  background-color: white;
  min-width: 200px;
  border: 1px solid rgba(0,0,0,0.15);
  border-radius: 4px;
  box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.1);
  z-index: 1;
  margin-top: 2px;
  white-space: nowrap;
  padding-top: 4px;
  padding-bottom: 4px;
}

.nav-dropdown-content hr {
  margin-top: 4px;
  margin-bottom: 4px;
  border: none;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.nav-dropdown-active {
  display: block;
}

.nav-dropdown-content a, .nav-dropdown-content .nav-dropdown-header {
  color: black;
  padding: 6px 24px;
  text-decoration: none;
  display: block;
  text-align: left;
}

.nav-dropdown-content .nav-dropdown-header {
  display: block;
  padding: 5px 24px;
  padding-bottom: 0;
  text-transform: uppercase;
  font-size: 14px;
  color: #999999;
  white-space: nowrap;
}

.nav-dropdown:hover .nav-dropbtn {
  color: white;
}

.nav-dropdown-content a:hover {
  background-color: #ddd;
  color: black;
}

.nav-right .nav-dropdown-content {
  margin-left: -45%;
  right: 0;
}

@media screen and (max-width: 768px) {
  .distill-site-header a, .distill-site-header .nav-dropdown  {display: none;}
  .distill-site-header a.nav-toggle {
    float: right;
    display: block;
  }
  .distill-site-header .title {
    margin-left: 0;
  }
  .distill-site-header .nav-right {
    margin-right: 0;
  }
  .distill-site-header {
    overflow: hidden;
  }
  .nav-right .nav-dropdown-content {
    margin-left: 0;
  }
}


@media screen and (max-width: 768px) {
  .distill-site-header.responsive {position: relative; min-height: 500px; }
  .distill-site-header.responsive a.nav-toggle {
    position: absolute;
    right: 0;
    top: 0;
  }
  .distill-site-header.responsive a,
  .distill-site-header.responsive .nav-dropdown {
    display: block;
    text-align: left;
  }
  .distill-site-header.responsive .nav-left,
  .distill-site-header.responsive .nav-right {
    width: 100%;
  }
  .distill-site-header.responsive .nav-dropdown {float: none;}
  .distill-site-header.responsive .nav-dropdown-content {position: relative;}
  .distill-site-header.responsive .nav-dropdown .nav-dropbtn {
    display: block;
    width: 100%;
    text-align: left;
  }
}

/* Site Footer */

.distill-site-footer {
  width: 100%;
  overflow: hidden;
  box-sizing: border-box;
  z-index: 3;
  margin-top: 30px;
  padding-top: 30px;
  padding-bottom: 30px;
  text-align: center;
}

/* Headroom */

d-title {
  padding-top: 6rem;
}

@media print {
  d-title {
    padding-top: 4rem;
  }
}

.headroom {
  z-index: 1000;
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
}

.headroom--transition {
  transition: all .4s ease-in-out;
}

.headroom--unpinned {
  top: -100px;
}

.headroom--pinned {
  top: 0;
}

/* adjust viewport for navbar height */
/* helps vertically center bootstrap (non-distill) content */
.min-vh-100 {
  min-height: calc(100vh - 100px) !important;
}

</style>

<script src="../../site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="../../site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet"/>
<link href="../../site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet"/>
<script src="../../site_libs/headroom-0.9.4/headroom.min.js"></script>
<!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

<style type="text/css">

body {
  background-color: white;
}

.pandoc-table {
  width: 100%;
}

.pandoc-table>caption {
  margin-bottom: 10px;
}

.pandoc-table th:not([align]) {
  text-align: left;
}

.pagedtable-footer {
  font-size: 15px;
}

d-byline .byline {
  grid-template-columns: 2fr 2fr;
}

d-byline .byline h3 {
  margin-block-start: 1.5em;
}

d-byline .byline .authors-affiliations h3 {
  margin-block-start: 0.5em;
}

.authors-affiliations .orcid-id {
  width: 16px;
  height:16px;
  margin-left: 4px;
  margin-right: 4px;
  vertical-align: middle;
  padding-bottom: 2px;
}

d-title .dt-tags {
  margin-top: 1em;
  grid-column: text;
}

.dt-tags .dt-tag {
  text-decoration: none;
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0em 0.4em;
  margin-right: 0.5em;
  margin-bottom: 0.4em;
  font-size: 70%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

d-article table.gt_table td,
d-article table.gt_table th {
  border-bottom: none;
}

.html-widget {
  margin-bottom: 2.0em;
}

.l-screen-inset {
  padding-right: 16px;
}

.l-screen .caption {
  margin-left: 10px;
}

.shaded {
  background: rgb(247, 247, 247);
  padding-top: 20px;
  padding-bottom: 20px;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .html-widget {
  margin-bottom: 0;
  border: 1px solid rgba(0, 0, 0, 0.1);
}

.shaded .shaded-content {
  background: white;
}

.text-output {
  margin-top: 0;
  line-height: 1.5em;
}

.hidden {
  display: none !important;
}

d-article {
  padding-top: 2.5rem;
  padding-bottom: 30px;
}

d-appendix {
  padding-top: 30px;
}

d-article>p>img {
  width: 100%;
}

d-article h2 {
  margin: 1rem 0 1.5rem 0;
}

d-article h3 {
  margin-top: 1.5rem;
}

d-article iframe {
  border: 1px solid rgba(0, 0, 0, 0.1);
  margin-bottom: 2.0em;
  width: 100%;
}

/* Tweak code blocks */

d-article div.sourceCode code,
d-article pre code {
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
}

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: auto;
}

d-article div.sourceCode {
  background-color: white;
}

d-article div.sourceCode pre {
  padding-left: 10px;
  font-size: 12px;
  border-left: 2px solid rgba(0,0,0,0.1);
}

d-article pre {
  font-size: 12px;
  color: black;
  background: none;
  margin-top: 0;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

d-article pre a {
  border-bottom: none;
}

d-article pre a:hover {
  border-bottom: none;
  text-decoration: underline;
}

d-article details {
  grid-column: text;
  margin-bottom: 0.8em;
}

@media(min-width: 768px) {

d-article pre,
d-article div.sourceCode,
d-article div.sourceCode pre {
  overflow: visible !important;
}

d-article div.sourceCode pre {
  padding-left: 18px;
  font-size: 14px;
}

d-article pre {
  font-size: 14px;
}

}

figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

/* CSS for d-contents */

.d-contents {
  grid-column: text;
  color: rgba(0,0,0,0.8);
  font-size: 0.9em;
  padding-bottom: 1em;
  margin-bottom: 1em;
  padding-bottom: 0.5em;
  margin-bottom: 1em;
  padding-left: 0.25em;
  justify-self: start;
}

@media(min-width: 1000px) {
  .d-contents.d-contents-float {
    height: 0;
    grid-column-start: 1;
    grid-column-end: 4;
    justify-self: center;
    padding-right: 3em;
    padding-left: 2em;
  }
}

.d-contents nav h3 {
  font-size: 18px;
  margin-top: 0;
  margin-bottom: 1em;
}

.d-contents li {
  list-style-type: none
}

.d-contents nav > ul {
  padding-left: 0;
}

.d-contents ul {
  padding-left: 1em
}

.d-contents nav ul li {
  margin-top: 0.6em;
  margin-bottom: 0.2em;
}

.d-contents nav a {
  font-size: 13px;
  border-bottom: none;
  text-decoration: none
  color: rgba(0, 0, 0, 0.8);
}

.d-contents nav a:hover {
  text-decoration: underline solid rgba(0, 0, 0, 0.6)
}

.d-contents nav > ul > li > a {
  font-weight: 600;
}

.d-contents nav > ul > li > ul {
  font-weight: inherit;
}

.d-contents nav > ul > li > ul > li {
  margin-top: 0.2em;
}


.d-contents nav ul {
  margin-top: 0;
  margin-bottom: 0.25em;
}

.d-article-with-toc h2:nth-child(2) {
  margin-top: 0;
}


/* Figure */

.figure {
  position: relative;
  margin-bottom: 2.5em;
  margin-top: 1.5em;
}

.figure img {
  width: 100%;
}

.figure .caption {
  color: rgba(0, 0, 0, 0.6);
  font-size: 12px;
  line-height: 1.5em;
}

.figure img.external {
  background: white;
  border: 1px solid rgba(0, 0, 0, 0.1);
  box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
  padding: 18px;
  box-sizing: border-box;
}

.figure .caption a {
  color: rgba(0, 0, 0, 0.6);
}

.figure .caption b,
.figure .caption strong, {
  font-weight: 600;
  color: rgba(0, 0, 0, 1.0);
}

/* Citations */

d-article .citation {
  color: inherit;
  cursor: inherit;
}

div.hanging-indent{
  margin-left: 1em; text-indent: -1em;
}

/* Citation hover box */

.tippy-box[data-theme~=light-border] {
  background-color: rgba(250, 250, 250, 0.95);
}

.tippy-content > p {
  margin-bottom: 0;
  padding: 2px;
}


/* Tweak 1000px media break to show more text */

@media(min-width: 1000px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 16px;
  }

  .grid {
    grid-column-gap: 16px;
  }

  d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
  }
  figure .caption, .figure .caption, figure figcaption {
    font-size: 13px;
  }
}

@media(min-width: 1180px) {
  .base-grid,
  distill-header,
  d-title,
  d-abstract,
  d-article,
  d-appendix,
  distill-appendix,
  d-byline,
  d-footnote-list,
  d-citation-list,
  distill-footer {
    grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
    grid-column-gap: 32px;
  }

  .grid {
    grid-column-gap: 32px;
  }
}


/* Get the citation styles for the appendix (not auto-injected on render since
   we do our own rendering of the citation appendix) */

d-appendix .citation-appendix,
.d-appendix .citation-appendix {
  font-size: 11px;
  line-height: 15px;
  border-left: 1px solid rgba(0, 0, 0, 0.1);
  padding-left: 18px;
  border: 1px solid rgba(0,0,0,0.1);
  background: rgba(0, 0, 0, 0.02);
  padding: 10px 18px;
  border-radius: 3px;
  color: rgba(150, 150, 150, 1);
  overflow: hidden;
  margin-top: -12px;
  white-space: pre-wrap;
  word-wrap: break-word;
}

/* Include appendix styles here so they can be overridden */

d-appendix {
  contain: layout style;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-top: 60px;
  margin-bottom: 0;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
  color: rgba(0,0,0,0.5);
  padding-top: 60px;
  padding-bottom: 48px;
}

d-appendix h3 {
  grid-column: page-start / text-start;
  font-size: 15px;
  font-weight: 500;
  margin-top: 1em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.65);
}

d-appendix h3 + * {
  margin-top: 1em;
}

d-appendix ol {
  padding: 0 0 0 15px;
}

@media (min-width: 768px) {
  d-appendix ol {
    padding: 0 0 0 30px;
    margin-left: -30px;
  }
}

d-appendix li {
  margin-bottom: 1em;
}

d-appendix a {
  color: rgba(0, 0, 0, 0.6);
}

d-appendix > * {
  grid-column: text;
}

d-appendix > d-footnote-list,
d-appendix > d-citation-list,
d-appendix > distill-appendix {
  grid-column: screen;
}

/* Include footnote styles here so they can be overridden */

d-footnote-list {
  contain: layout style;
}

d-footnote-list > * {
  grid-column: text;
}

d-footnote-list a.footnote-backlink {
  color: rgba(0,0,0,0.3);
  padding-left: 0.5em;
}



/* Anchor.js */

.anchorjs-link {
  /*transition: all .25s linear; */
  text-decoration: none;
  border-bottom: none;
}
*:hover > .anchorjs-link {
  margin-left: -1.125em !important;
  text-decoration: none;
  border-bottom: none;
}

/* Social footer */

.social_footer {
  margin-top: 30px;
  margin-bottom: 0;
  color: rgba(0,0,0,0.67);
}

.disqus-comments {
  margin-right: 30px;
}

.disqus-comment-count {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
  cursor: pointer;
}

#disqus_thread {
  margin-top: 30px;
}

.article-sharing a {
  border-bottom: none;
  margin-right: 8px;
}

.article-sharing a:hover {
  border-bottom: none;
}

.sidebar-section.subscribe {
  font-size: 12px;
  line-height: 1.6em;
}

.subscribe p {
  margin-bottom: 0.5em;
}


.article-footer .subscribe {
  font-size: 15px;
  margin-top: 45px;
}


.sidebar-section.custom {
  font-size: 12px;
  line-height: 1.6em;
}

.custom p {
  margin-bottom: 0.5em;
}

/* Styles for listing layout (hide title) */
.layout-listing d-title, .layout-listing .d-title {
  display: none;
}

/* Styles for posts lists (not auto-injected) */


.posts-with-sidebar {
  padding-left: 45px;
  padding-right: 45px;
}

.posts-list .description h2,
.posts-list .description p {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

.posts-list .description h2 {
  font-weight: 700;
  border-bottom: none;
  padding-bottom: 0;
}

.posts-list h2.post-tag {
  border-bottom: 1px solid rgba(0, 0, 0, 0.2);
  padding-bottom: 12px;
}
.posts-list {
  margin-top: 60px;
  margin-bottom: 24px;
}

.posts-list .post-preview {
  text-decoration: none;
  overflow: hidden;
  display: block;
  border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  padding: 24px 0;
}

.post-preview-last {
  border-bottom: none !important;
}

.posts-list .posts-list-caption {
  grid-column: screen;
  font-weight: 400;
}

.posts-list .post-preview h2 {
  margin: 0 0 6px 0;
  line-height: 1.2em;
  font-style: normal;
  font-size: 24px;
}

.posts-list .post-preview p {
  margin: 0 0 12px 0;
  line-height: 1.4em;
  font-size: 16px;
}

.posts-list .post-preview .thumbnail {
  box-sizing: border-box;
  margin-bottom: 24px;
  position: relative;
  max-width: 500px;
}
.posts-list .post-preview img {
  width: 100%;
  display: block;
}

.posts-list .metadata {
  font-size: 12px;
  line-height: 1.4em;
  margin-bottom: 18px;
}

.posts-list .metadata > * {
  display: inline-block;
}

.posts-list .metadata .publishedDate {
  margin-right: 2em;
}

.posts-list .metadata .dt-authors {
  display: block;
  margin-top: 0.3em;
  margin-right: 2em;
}

.posts-list .dt-tags {
  display: block;
  line-height: 1em;
}

.posts-list .dt-tags .dt-tag {
  display: inline-block;
  color: rgba(0,0,0,0.6);
  padding: 0.3em 0.4em;
  margin-right: 0.2em;
  margin-bottom: 0.4em;
  font-size: 60%;
  border: 1px solid rgba(0,0,0,0.2);
  border-radius: 3px;
  text-transform: uppercase;
  font-weight: 500;
}

.posts-list img {
  opacity: 1;
}

.posts-list img[data-src] {
  opacity: 0;
}

.posts-more {
  clear: both;
}


.posts-sidebar {
  font-size: 16px;
}

.posts-sidebar h3 {
  font-size: 16px;
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 400;
  text-transform: uppercase;
}

.sidebar-section {
  margin-bottom: 30px;
}

.categories ul {
  list-style-type: none;
  margin: 0;
  padding: 0;
}

.categories li {
  color: rgba(0, 0, 0, 0.8);
  margin-bottom: 0;
}

.categories li>a {
  border-bottom: none;
}

.categories li>a:hover {
  border-bottom: 1px solid rgba(0, 0, 0, 0.4);
}

.categories .active {
  font-weight: 600;
}

.categories .category-count {
  color: rgba(0, 0, 0, 0.4);
}


@media(min-width: 768px) {
  .posts-list .post-preview h2 {
    font-size: 26px;
  }
  .posts-list .post-preview .thumbnail {
    float: right;
    width: 30%;
    margin-bottom: 0;
  }
  .posts-list .post-preview .description {
    float: left;
    width: 45%;
  }
  .posts-list .post-preview .metadata {
    float: left;
    width: 20%;
    margin-top: 8px;
  }
  .posts-list .post-preview p {
    margin: 0 0 12px 0;
    line-height: 1.5em;
    font-size: 16px;
  }
  .posts-with-sidebar .posts-list {
    float: left;
    width: 75%;
  }
  .posts-with-sidebar .posts-sidebar {
    float: right;
    width: 20%;
    margin-top: 60px;
    padding-top: 24px;
    padding-bottom: 24px;
  }
}


/* Improve display for browsers without grid (IE/Edge <= 15) */

.downlevel {
  line-height: 1.6em;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  margin: 0;
}

.downlevel .d-title {
  padding-top: 6rem;
  padding-bottom: 1.5rem;
}

.downlevel .d-title h1 {
  font-size: 50px;
  font-weight: 700;
  line-height: 1.1em;
  margin: 0 0 0.5rem;
}

.downlevel .d-title p {
  font-weight: 300;
  font-size: 1.2rem;
  line-height: 1.55em;
  margin-top: 0;
}

.downlevel .d-byline {
  padding-top: 0.8em;
  padding-bottom: 0.8em;
  font-size: 0.8rem;
  line-height: 1.8em;
}

.downlevel .section-separator {
  border: none;
  border-top: 1px solid rgba(0, 0, 0, 0.1);
}

.downlevel .d-article {
  font-size: 1.06rem;
  line-height: 1.7em;
  padding-top: 1rem;
  padding-bottom: 2rem;
}


.downlevel .d-appendix {
  padding-left: 0;
  padding-right: 0;
  max-width: none;
  font-size: 0.8em;
  line-height: 1.7em;
  margin-bottom: 0;
  color: rgba(0,0,0,0.5);
  padding-top: 40px;
  padding-bottom: 48px;
}

.downlevel .footnotes ol {
  padding-left: 13px;
}

.downlevel .base-grid,
.downlevel .distill-header,
.downlevel .d-title,
.downlevel .d-abstract,
.downlevel .d-article,
.downlevel .d-appendix,
.downlevel .distill-appendix,
.downlevel .d-byline,
.downlevel .d-footnote-list,
.downlevel .d-citation-list,
.downlevel .distill-footer,
.downlevel .appendix-bottom,
.downlevel .posts-container {
  padding-left: 40px;
  padding-right: 40px;
}

@media(min-width: 768px) {
  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
  padding-left: 150px;
  padding-right: 150px;
  max-width: 900px;
}
}

.downlevel pre code {
  display: block;
  border-left: 2px solid rgba(0, 0, 0, .1);
  padding: 0 0 0 20px;
  font-size: 14px;
}

.downlevel code, .downlevel pre {
  color: black;
  background: none;
  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  text-align: left;
  white-space: pre;
  word-spacing: normal;
  word-break: normal;
  word-wrap: normal;
  line-height: 1.5;

  -moz-tab-size: 4;
  -o-tab-size: 4;
  tab-size: 4;

  -webkit-hyphens: none;
  -moz-hyphens: none;
  -ms-hyphens: none;
  hyphens: none;
}

.downlevel .posts-list .post-preview {
  color: inherit;
}



</style>

<script type="application/javascript">

function is_downlevel_browser() {
  if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                 window.navigator.userAgent)) {
    return true;
  } else {
    return window.load_distill_framework === undefined;
  }
}

// show body when load is complete
function on_load_complete() {

  // add anchors
  if (window.anchors) {
    window.anchors.options.placement = 'left';
    window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
  }


  // set body to visible
  document.body.style.visibility = 'visible';

  // force redraw for leaflet widgets
  if (window.HTMLWidgets) {
    var maps = window.HTMLWidgets.findAll(".leaflet");
    $.each(maps, function(i, el) {
      var map = this.getMap();
      map.invalidateSize();
      map.eachLayer(function(layer) {
        if (layer instanceof L.TileLayer)
          layer.redraw();
      });
    });
  }

  // trigger 'shown' so htmlwidgets resize
  $('d-article').trigger('shown');
}

function init_distill() {

  init_common();

  // create front matter
  var front_matter = $('<d-front-matter></d-front-matter>');
  $('#distill-front-matter').wrap(front_matter);

  // create d-title
  $('.d-title').changeElementType('d-title');

  // create d-byline
  var byline = $('<d-byline></d-byline>');
  $('.d-byline').replaceWith(byline);

  // create d-article
  var article = $('<d-article></d-article>');
  $('.d-article').wrap(article).children().unwrap();

  // move posts container into article
  $('.posts-container').appendTo($('d-article'));

  // create d-appendix
  $('.d-appendix').changeElementType('d-appendix');

  // flag indicating that we have appendix items
  var appendix = $('.appendix-bottom').children('h3').length > 0;

  // replace footnotes with <d-footnote>
  $('.footnote-ref').each(function(i, val) {
    appendix = true;
    var href = $(this).attr('href');
    var id = href.replace('#', '');
    var fn = $('#' + id);
    var fn_p = $('#' + id + '>p');
    fn_p.find('.footnote-back').remove();
    var text = fn_p.html();
    var dtfn = $('<d-footnote></d-footnote>');
    dtfn.html(text);
    $(this).replaceWith(dtfn);
  });
  // remove footnotes
  $('.footnotes').remove();

  // move refs into #references-listing
  $('#references-listing').replaceWith($('#refs'));

  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    var id = $(this).attr('id');
    $('.d-contents a[href="#' + id + '"]').parent().remove();
    appendix = true;
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
  });

  // show d-appendix if we have appendix content
  $("d-appendix").css('display', appendix ? 'grid' : 'none');

  // localize layout chunks to just output
  $('.layout-chunk').each(function(i, val) {

    // capture layout
    var layout = $(this).attr('data-layout');

    // apply layout to markdown level block elements
    var elements = $(this).children().not('details, div.sourceCode, pre, script');
    elements.each(function(i, el) {
      var layout_div = $('<div class="' + layout + '"></div>');
      if (layout_div.hasClass('shaded')) {
        var shaded_content = $('<div class="shaded-content"></div>');
        $(this).wrap(shaded_content);
        $(this).parent().wrap(layout_div);
      } else {
        $(this).wrap(layout_div);
      }
    });


    // unwrap the layout-chunk div
    $(this).children().unwrap();
  });

  // remove code block used to force  highlighting css
  $('.distill-force-highlighting-css').parent().remove();

  // remove empty line numbers inserted by pandoc when using a
  // custom syntax highlighting theme
  $('code.sourceCode a:empty').remove();

  // load distill framework
  load_distill_framework();

  // wait for window.distillRunlevel == 4 to do post processing
  function distill_post_process() {

    if (!window.distillRunlevel || window.distillRunlevel < 4)
      return;

    // hide author/affiliations entirely if we have no authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;
    if (!have_authors)
      $('d-byline').addClass('hidden');

    // article with toc class
    $('.d-contents').parent().addClass('d-article-with-toc');

    // strip links that point to #
    $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

    // add orcid ids
    $('.authors-affiliations').find('.author').each(function(i, el) {
      var orcid_id = front_matter.authors[i].orcidID;
      if (orcid_id) {
        var a = $('<a></a>');
        a.attr('href', 'https://orcid.org/' + orcid_id);
        var img = $('<img></img>');
        img.addClass('orcid-id');
        img.attr('alt', 'ORCID ID');
        img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
        a.append(img);
        $(this).append(a);
      }
    });

    // hide elements of author/affiliations grid that have no value
    function hide_byline_column(caption) {
      $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
    }

    // affiliations
    var have_affiliations = false;
    for (var i = 0; i<front_matter.authors.length; ++i) {
      var author = front_matter.authors[i];
      if (author.affiliation !== "&nbsp;") {
        have_affiliations = true;
        break;
      }
    }
    if (!have_affiliations)
      $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

    // published date
    if (!front_matter.publishedDate)
      hide_byline_column("Published");

    // document object identifier
    var doi = $('d-byline').find('h3:contains("DOI")');
    var doi_p = doi.next().empty();
    if (!front_matter.doi) {
      // if we have a citation and valid citationText then link to that
      if ($('#citation').length > 0 && front_matter.citationText) {
        doi.html('Citation');
        $('<a href="#citation"></a>')
          .text(front_matter.citationText)
          .appendTo(doi_p);
      } else {
        hide_byline_column("DOI");
      }
    } else {
      $('<a></a>')
         .attr('href', "https://doi.org/" + front_matter.doi)
         .html(front_matter.doi)
         .appendTo(doi_p);
    }

     // change plural form of authors/affiliations
    if (front_matter.authors.length === 1) {
      var grid = $('.authors-affiliations');
      grid.children('h3:contains("Authors")').text('Author');
      grid.children('h3:contains("Affiliations")').text('Affiliation');
    }

    // remove d-appendix and d-footnote-list local styles
    $('d-appendix > style:first-child').remove();
    $('d-footnote-list > style:first-child').remove();

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // hoverable references
    $('span.citation[data-cites]').each(function() {
      var refHtml = $('#ref-' + $(this).attr('data-cites')).html();
      window.tippy(this, {
        allowHTML: true,
        content: refHtml,
        maxWidth: 500,
        interactive: true,
        interactiveBorder: 10,
        theme: 'light-border',
        placement: 'bottom-start'
      });
    });

    // clear polling timer
    clearInterval(tid);

    // show body now that everything is ready
    on_load_complete();
  }

  var tid = setInterval(distill_post_process, 50);
  distill_post_process();

}

function init_downlevel() {

  init_common();

   // insert hr after d-title
  $('.d-title').after($('<hr class="section-separator"/>'));

  // check if we have authors
  var front_matter = JSON.parse($("#distill-front-matter").html());
  var have_authors = front_matter.authors && front_matter.authors.length > 0;

  // manage byline/border
  if (!have_authors)
    $('.d-byline').remove();
  $('.d-byline').after($('<hr class="section-separator"/>'));
  $('.d-byline a').remove();

  // remove toc
  $('.d-contents').remove();

  // move appendix elements
  $('h1.appendix, h2.appendix').each(function(i, val) {
    $(this).changeElementType('h3');
  });
  $('h3.appendix').each(function(i, val) {
    $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
  });


  // inject headers into references and footnotes
  var refs_header = $('<h3></h3>');
  refs_header.text('References');
  $('#refs').prepend(refs_header);

  var footnotes_header = $('<h3></h3');
  footnotes_header.text('Footnotes');
  $('.footnotes').children('hr').first().replaceWith(footnotes_header);

  // move appendix-bottom entries to the bottom
  $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
  $('.appendix-bottom').remove();

  // remove appendix if it's empty
  if ($('.d-appendix').children().length === 0)
    $('.d-appendix').remove();

  // prepend separator above appendix
  $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

  // trim code
  $('pre>code').each(function(i, val) {
    $(this).html($.trim($(this).html()));
  });

  // move posts-container right before article
  $('.posts-container').insertBefore($('.d-article'));

  $('body').addClass('downlevel');

  on_load_complete();
}


function init_common() {

  // jquery plugin to change element types
  (function($) {
    $.fn.changeElementType = function(newType) {
      var attrs = {};

      $.each(this[0].attributes, function(idx, attr) {
        attrs[attr.nodeName] = attr.nodeValue;
      });

      this.replaceWith(function() {
        return $("<" + newType + "/>", attrs).append($(this).contents());
      });
    };
  })(jQuery);

  // prevent underline for linked images
  $('a > img').parent().css({'border-bottom' : 'none'});

  // mark non-body figures created by knitr chunks as 100% width
  $('.layout-chunk').each(function(i, val) {
    var figures = $(this).find('img, .html-widget');
    if ($(this).attr('data-layout') !== "l-body") {
      figures.css('width', '100%');
    } else {
      figures.css('max-width', '100%');
      figures.filter("[width]").each(function(i, val) {
        var fig = $(this);
        fig.css('width', fig.attr('width') + 'px');
      });

    }
  });

  // auto-append index.html to post-preview links in file: protocol
  // and in rstudio ide preview
  $('.post-preview').each(function(i, val) {
    if (window.location.protocol === "file:")
      $(this).attr('href', $(this).attr('href') + "index.html");
  });

  // get rid of index.html references in header
  if (window.location.protocol !== "file:") {
    $('.distill-site-header a[href]').each(function(i,val) {
      $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
    });
  }

  // add class to pandoc style tables
  $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
  $('.kable-table').children('table').addClass('pandoc-table');

  // add figcaption style to table captions
  $('caption').parent('table').addClass("figcaption");

  // initialize posts list
  if (window.init_posts_list)
    window.init_posts_list();

  // implmement disqus comment link
  $('.disqus-comment-count').click(function() {
    window.headroom_prevent_pin = true;
    $('#disqus_thread').toggleClass('hidden');
    if (!$('#disqus_thread').hasClass('hidden')) {
      var offset = $(this).offset();
      $(window).resize();
      $('html, body').animate({
        scrollTop: offset.top - 35
      });
    }
  });
}

document.addEventListener('DOMContentLoaded', function() {
  if (is_downlevel_browser())
    init_downlevel();
  else
    window.addEventListener('WebComponentsReady', init_distill);
});

</script>

<style type="text/css">
/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */



html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.06rem;
  --code-size:       14px;
  --aside-size:      12px;
  --fig-cap-size:    13px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --header-color:    rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    sans-serif;
  --mono-font:       monospace;
  --body-font:       sans-serif;
  --navbar-font:     sans-serif;  /* websites + blogs only */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       0.8em;
  --text-color:      rgba(0, 0, 0, 0.5);
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #0F2E3D;
}

/*-- Additional custom styles --*/
/* Add any additional CSS rules below                      */
</style>
<style type="text/css">/* base variables */

/* Edit the CSS properties in this file to create a custom
   Distill theme. Only edit values in the right column
   for each row; values shown are the CSS defaults.
   To return any property to the default,
   you may set its value to: unset
   All rows must end with a semi-colon.                      */

/* Optional: embed custom fonts here with `@import`          */
/* This must remain at the top of this file.                 */
@import url('https://fonts.googleapis.com/css2?family=Montserrat');


html {
  /*-- Main font sizes --*/
  --title-size:      50px;
  --body-size:       1.2rem;                   /* edited */
  --code-size:       1.0rem;
  --aside-size:      20px;
  --fig-cap-size:    20px;
  /*-- Main font colors --*/
  --title-color:     #000000;
  --heading-color:   rgba(0, 0, 0, 0.8);
  --body-color:      rgba(0, 0, 0, 0.8);
  --aside-color:     rgba(0, 0, 0, 0.6);
  --fig-cap-color:   rgba(0, 0, 0, 0.6);
  /*-- Specify custom fonts ~~~ must be imported above   --*/
  --heading-font:    'Montsereat Semi-bold 600', sans-serif;        /* edited */
  --mono-font:       Montserrat;
  --body-font:       'Montserrat Regular 400', sans-serif;        /* edited */
  --navbar-font:     'Montserrat Medium 500', sans-serif;        /* edited */
}

/*-- ARTICLE METADATA --*/
d-byline {
  --heading-size:    0.6rem;
  --heading-color:   rgba(0, 0, 0, 0.5);
  --body-size:       0.8rem;
  --body-color:      rgba(0, 0, 0, 0.8);
}

/*-- ARTICLE TABLE OF CONTENTS --*/
.d-contents {
  --heading-size:    18px;
  --contents-size:   13px;
}

/*-- ARTICLE APPENDIX --*/
d-appendix {
  --heading-size:    15px;
  --heading-color:   rgba(0, 0, 0, 0.65);
  --text-size:       1.075rem;                   /* edited */
  --text-color:      rgb(0, 0, 0);               /* edited */
}

/*-- WEBSITE HEADER + FOOTER --*/
/* These properties only apply to Distill sites and blogs  */

.distill-site-header {
  --title-size:       18px;
  --text-color:       #FFFFFF;                     /* edited */
  --text-size:        15px;
  --hover-color:      #7393B3;                  /* edited */
  --bkgd-color:       #0c2c29;                     /* edited */
}

.distill-site-footer {
  --text-color:       rgba(255, 255, 255, 0.8);
  --text-size:        15px;
  --hover-color:      white;
  --bkgd-color:       #D4F1F4;
}

/*-- Additional custom styles --*/

.categories li > a:hover {
    color: #00ff00;
    border-bottom: 1px #00ff00;
}

p a:hover  {
    color: #00ff00;
}

/* Change appearance of headers */
h1, h2, h3, h4, h5 {
    font-weight: 700;
}

/* Use specific font in the body of the text */
html, body, p {
    font-weight: 200;
    /*line-height: 1.3rem; */
    /*font-style: normal;*/
}

/* Change the appearance of code chunks -- added*/ 
d-article div.sourceCode pre {
  overflow-x: scroll !important;
  font-family: 'Cardo', sans-serif;
  color: #383838;
  font-size: 25%;
  line-height: 1.45;
  background-color: #eee;
  border-left: 0;
  white-space: pre-wrap;
  width:auto;
}

ul > li::marker {
    font-weight: 700;
    font-size: 1.125em;
}</style>
<style type="text/css">
/* base style */

/* FONT FAMILIES */

:root {
  --heading-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
  --mono-default: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  --body-default: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
}

body,
.posts-list .post-preview p,
.posts-list .description p {
  font-family: var(--body-font), var(--body-default);
}

h1, h2, h3, h4, h5, h6,
.posts-list .post-preview h2,
.posts-list .description h2 {
  font-family: var(--heading-font), var(--heading-default);
}

d-article div.sourceCode code,
d-article pre code {
  font-family: var(--mono-font), var(--mono-default);
}


/*-- TITLE --*/
d-title h1,
.posts-list > h1 {
  color: var(--title-color, black);
}

d-title h1 {
  font-size: var(--title-size, 50px);
}

/*-- HEADERS --*/
d-article h1,
d-article h2,
d-article h3,
d-article h4,
d-article h5,
d-article h6 {
  color: var(--header-color, rgba(0, 0, 0, 0.8));
}

/*-- BODY --*/
d-article > p,  /* only text inside of <p> tags */
d-article > ul, /* lists */
d-article > ol {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
  font-size: var(--body-size, 1.06rem);
}


/*-- CODE --*/
d-article div.sourceCode code,
d-article pre code {
  font-size: var(--code-size, 14px);
}

/*-- ASIDE --*/
d-article aside {
  font-size: var(--aside-size, 12px);
  color: var(--aside-color, rgba(0, 0, 0, 0.6));
}

/*-- FIGURE CAPTIONS --*/
figure .caption,
figure figcaption,
.figure .caption {
  font-size: var(--fig-cap-size, 13px);
  color: var(--fig-cap-color, rgba(0, 0, 0, 0.6));
}

/*-- METADATA --*/
d-byline h3 {
  font-size: var(--heading-size, 0.6rem);
  color: var(--heading-color, rgba(0, 0, 0, 0.5));
}

d-byline {
  font-size: var(--body-size, 0.8rem);
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

d-byline a,
d-article d-byline a {
  color: var(--body-color, rgba(0, 0, 0, 0.8));
}

/*-- TABLE OF CONTENTS --*/
.d-contents nav h3 {
  font-size: var(--heading-size, 18px);
}

.d-contents nav a {
  font-size: var(--contents-size, 13px);
}

/*-- APPENDIX --*/
d-appendix h3 {
  font-size: var(--heading-size, 15px);
  color: var(--heading-color, rgba(0, 0, 0, 0.65));
}

d-appendix {
  font-size: var(--text-size, 0.8em);
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

d-appendix d-footnote-list a.footnote-backlink {
  color: var(--text-color, rgba(0, 0, 0, 0.5));
}

/*-- WEBSITE HEADER + FOOTER --*/
.distill-site-header .title {
  font-size: var(--title-size, 18px);
  font-family: var(--navbar-font), var(--heading-default);
}

.distill-site-header a,
.nav-dropdown .nav-dropbtn {
  font-family: var(--navbar-font), var(--heading-default);
}

.nav-dropdown .nav-dropbtn {
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  font-size: var(--text-size, 15px);
}

.distill-site-header a:hover,
.nav-dropdown:hover .nav-dropbtn {
  color: var(--hover-color, white);
}

.distill-site-header {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer {
  font-size: var(--text-size, 15px);
  color: var(--text-color, rgba(255, 255, 255, 0.8));
  background-color: var(--bkgd-color, #0F2E3D);
}

.distill-site-footer a:hover {
  color: var(--hover-color, white);
}</style>
<!--/radix_placeholder_distill-->
  <script src="../../site_libs/header-attrs-2.10/header-attrs.js"></script>
  <script src="../../site_libs/jquery-1.11.3/jquery.min.js"></script>
  <script src="../../site_libs/popper-2.6.0/popper.min.js"></script>
  <link href="../../site_libs/tippy-6.2.7/tippy.css" rel="stylesheet" />
  <link href="../../site_libs/tippy-6.2.7/tippy-light-border.css" rel="stylesheet" />
  <script src="../../site_libs/tippy-6.2.7/tippy.umd.min.js"></script>
  <script src="../../site_libs/anchor-4.2.2/anchor.min.js"></script>
  <script src="../../site_libs/bowser-1.9.3/bowser.min.js"></script>
  <script src="../../site_libs/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="../../site_libs/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
<!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"Take-home Exercise 1","description":"Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia","authors":[{"author":"Lye Jia Wei","authorURL":"https://lye-jia-wei.github.io/","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2021-08-30T00:00:00.000+08:00","citationText":"Wei, 2021"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<header class="header header--fixed" role="banner">
<nav class="distill-site-nav distill-site-header">
<div class="nav-left">
<a href="../../index.html" class="title">IS415 Blog</a>
</div>
<div class="nav-right">
<div class="nav-dropdown">
<button class="nav-dropbtn">
Hands-on Ex
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../hands-on-exercise-2.html">Hands-on Ex 2</a>
<a href="../../hands-on-exercise-3.html">Hands-on Ex 3</a>
<a href="../../hands-on-exercise-4.html">Hands-on Ex 4</a>
<a href="../../hands-on-exercise-5.html">Hands-on Ex 5</a>
<a href="../../hands-on-exercise-6.html">Hands-on Ex 6</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
In-class Ex
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="../../in-class-exercise-2.html">In-class Ex 2</a>
<a href="../../in-class-exercise-3.html">In-class Ex 3</a>
<a href="../../in-class-exercise-4.html">In-class Ex 4</a>
<a href="../../in-class-exercise-5.html">In-class Ex 5</a>
<a href="../../in-class-exercise-6.html">In-class Ex 6</a>
</div>
</div>
<div class="nav-dropdown">
<button class="nav-dropbtn">
Take-home Ex
 
<span class="down-arrow">&#x25BE;</span>
</button>
<div class="nav-dropdown-content">
<a href="https://lye-jia-wei-is415.netlify.app/posts/2021-08-30-take-home-exercise-1/">Take-home Ex 1</a>
<a href="../../take-home-exercise-2.html">Take home Ex 2</a>
</div>
</div>
<a href="../../about.html">About</a>
<a href="javascript:void(0);" class="nav-toggle">&#9776;</a>
</div>
</nav>
</header>
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>Take-home Exercise 1</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>Analysing and Visualising Spatio-temporal Patterns of COVID-19 in DKI Jakarta, Indonesia</p></p>
</div>

<div class="d-byline">
  Lye Jia Wei <a href="https://lye-jia-wei.github.io/" class="uri">https://lye-jia-wei.github.io/</a> 
  
<br/>08-30-2021
</div>

<div class="d-article">
<div class="d-contents d-contents-float">
<nav class="l-text toc figcaption" id="TOC">
<h3>Contents</h3>
<ul>
<li><a href="#introduction">1. Introduction</a></li>
<li><a href="#problem-statement">2. Problem Statement</a></li>
<li><a href="#data">3. Data</a></li>
<li><a href="#getting-started">4. Getting Started</a></li>
<li><a href="#data-import">5. Data Import</a></li>
<li><a href="#data-extraction-wrangling-and-integration">6. Data Extraction, Wrangling and Integration</a></li>
<li><a href="#study-area">7. Study Area</a></li>
<li><a href="#data-inspection-cleaning-round-2">8. Data Inspection &amp; Cleaning Round 2</a></li>
<li><a href="#writing-and-reading-rds">9. Writing and Reading RDS</a></li>
<li><a href="#exploratory-data-analysis">10. Exploratory Data Analysis</a></li>
<li><a href="#thematic-mapping">11. Thematic Mapping</a></li>
<li><a href="#analytical-map">12. Analytical Map</a></li>
<li><a href="#localised-geospatial-statistic">13. Localised Geospatial Statistic</a></li>
<li><a href="#conclusion">14. Conclusion</a></li>
<li><a href="#references">15. References</a></li>
</ul>
</nav>
</div>
<h2 id="introduction">1. Introduction</h2>
<p>Since late December 2019, an outbreak of a novel coronavirus disease (COVID-19; previously known as 2019-nCoV) was reported in Wuhan, China, which had subsequently affected 210 countries worldwide. In general, COVID-19 is an acute resolved disease but it can also be deadly, with a 2% case fatality rate.</p>
<p>The COVID-19 pandemic in Indonesia is part of the ongoing worldwide pandemic of coronavirus disease 2019 (COVID-19) caused by severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2). The virus was confirmed to have reached Indonesia on March 2, 2020. It started with two cases in March. As of July 31 2021, there had been 3,409,658 cumulative confirmed cases of COVID-19 in Indonesia and 94,119 reported cumulative deaths. All cases were spread in 34 provinces in Indonesia. Among all the provinces, DKI Jakarta (Indonesian: Daerah Khusus Ibukota Jakarta and in English: Special Capital Region of Jakarta) contributed close to 24% of the cumulative confirmed cases.</p>
<h2 id="problem-statement">2. Problem Statement</h2>
<p>Given that the cumulative confirmed cases were not evenly distributed within DKI Jakarta, this geospatial analysis aims to</p>
<ul>
<li><ol type="1">
<li>Reveal the spatial-temporal patterns of COVID-19 case in DKI Jakarta</li>
</ol></li>
<li><ol start="2" type="1">
<li>Find out sub-districts with relatively higher number of confirmed cases</li>
</ol></li>
<li><ol start="3" type="1">
<li>Identify trends of COVID-19 case in the sub-districts and how they change over time.</li>
</ol></li>
</ul>
<h2 id="data">3. Data</h2>
<p>In this analysis, the following dataset were used:</p>
<div class="layout-chunk" data-layout="l-body">
<table>
<colgroup>
<col style="width: 10%" />
<col style="width: 38%" />
<col style="width: 4%" />
<col style="width: 47%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Data</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Format</th>
<th style="text-align: left;">Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Jakarta COVID-19 Data</td>
<td style="text-align: left;">Daily COVID-19 data of DKI Jakarta compiled monthly between March 2020 to July 2021</td>
<td style="text-align: left;">XLSX</td>
<td style="text-align: left;"><a href="https://riwayat-file-covid-19-dki-jakarta-jakartagis.hub.arcgis.com/">Open Data Covid-19 Provinsi DKI</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">DKI Jarkata shapefile</td>
<td style="text-align: left;">Jakarta sub-district</td>
<td style="text-align: left;">Shapefile</td>
<td style="text-align: left;"><a href="https://www.indonesia-geospasial.com/p/sitemap.html">Indonesia Geospatial Data</a></td>
</tr>
</tbody>
</table>
</div>
<p>*Note: Jakarta COVID-19 data file for last day of each month is used with the exception of missing file for January 2021</p>
<h2 id="getting-started">4. Getting Started</h2>
<p>In this exercise, the key R package use is tmap package in R. Beside tmap package, seven other R packages will be used. They are:</p>
<ul>
<li>sf for handling geospatial data</li>
<li>tidyverse for subsetting and transforming data</li>
<li>ReadXL for importing XLSX file</li>
<li>plotly for data visualization</li>
<li>dplyr for data maniupulation</li>
<li>plyr for splitting, applying and combining data</li>
<li>tmap to produce thematic map</li>
<li>spdep to create spatial weights matrix objects</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>packages</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'sf'</span>,<span class='st'>'tidyverse'</span>,<span class='st'>'readxl'</span>,<span class='st'>'plotly'</span>,<span class='st'>'dplyr'</span>,<span class='st'>'plyr'</span>,<span class='st'>'tmap'</span>,<span class='st'>'spdep'</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>p</span> <span class='kw'>in</span> <span class='va'>packages</span><span class='op'>)</span><span class='op'>{</span>
  <span class='kw'>if</span><span class='op'>(</span><span class='op'>!</span><span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span><span class='op'>)</span><span class='op'>{</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/install.packages.html'>install.packages</a></span><span class='op'>(</span><span class='va'>p</span><span class='op'>)</span>
  <span class='op'>}</span>
  <span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'>p</span>, character.only <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<h2 id="data-import">5. Data Import</h2>
<h3 id="importing-geospatial-data-into-r">5.1 Importing Geospatial Data Into R</h3>
<p>Import the data and examine the content of the data set.</p>
<ul>
<li>Data will first be imported as an sf object to facilitate data pre-processing and initial analysis, then converted to sp class in the later part of the analysis.</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>=</span> <span class='fu'>st_read</span><span class='op'>(</span>dsn<span class='op'>=</span><span class='st'>"data/geospatial"</span>,layer<span class='op'>=</span><span class='st'>"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Reading layer `BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA&#39; from data source `C:\Users\User\Desktop\IS415\lye-jia-wei\IS415_blog\_posts\2021-08-30-take-home-exercise-1\data\geospatial&#39; 
  using driver `ESRI Shapefile&#39;
Simple feature collection with 269 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 106.3831 ymin: -6.370815 xmax: 106.9728 ymax: -5.184322
Geodetic CRS:  WGS 84</code></pre>
</div>
<p>The message above reveals that the geospatial objects are multipolygon features. There are a total of 269 multipolygon features and 161 fields in DKI_Jakarta simple feature data frame. DKI is in WGS84 projected coordinates systems.</p>
<h3 id="importing-attribute-data-into-r">5.2 Importing Attribute Data Into R</h3>
<p>Next, we will import monthly Covid-19 data XLSX file from a folder into RStudio and save it into an R dataframe called Covid_DF.</p>
<h4 id="reading-xlsx-file">5.2.1 Reading XLSX File</h4>
<p>The task will be performed by using lapply() in combination with read_xlsx() function to identify all the xlsx file and then applying a function to transform the file in the File_List as shown in the code chunk below. We will also be adding ‘Date’ field to extract the date from file name in the subsequent step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>File_List</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.files.html'>list.files</a></span><span class='op'>(</span>path <span class='op'>=</span> <span class='st'>"C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial"</span> , pattern <span class='op'>=</span> <span class='st'>"*.xlsx"</span>,  full.names <span class='op'>=</span> <span class='cn'>T</span><span class='op'>)</span>

<span class='va'>DF_List</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq_along</a></span><span class='op'>(</span><span class='va'>File_List</span><span class='op'>)</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/transform.html'>transform</a></span><span class='op'>(</span><span class='fu'>read_xlsx</span><span class='op'>(</span><span class='va'>File_List</span><span class='op'>[</span><span class='va'>x</span><span class='op'>]</span><span class='op'>)</span>, Date <span class='op'>=</span> <span class='va'>File_List</span><span class='op'>[</span><span class='va'>x</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="creating-dataframe">5.2.2 Creating Dataframe</h4>
<p>We will then convert the DF_List into dataframe called Covid_DF using the ldpy function. This will be a temporary dataframe which we will then carry out data cleaning in the later step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='fu'>ldply</span><span class='op'>(</span><span class='va'>DF_List</span>, <span class='va'>data.frame</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="data-extraction-wrangling-and-integration">6. Data Extraction, Wrangling and Integration</h2>
<h3 id="geospatial-data">6.1 Geospatial Data</h3>
<h4 id="data-cleaning">6.1.1 Data Cleaning</h4>
<p>First, we have to ensure that spatial data used for analysis has no invalid geometries.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>st_is_valid</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span> <span class='op'>==</span> <span class='cn'>FALSE</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] 0</code></pre>
</div>
<ul>
<li>There are no invalid geometries in the data that needs to be handled.</li>
</ul>
<p>Check the geospatial data for missing values, as missing values can impact future calculations.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span><span class='op'>)</span><span class='op'>!=</span><span class='fl'>0</span>,<span class='op'>]</span>
</code></pre>
</div>
<pre><code>Simple feature collection with 2 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 106.8412 ymin: -6.154036 xmax: 106.8612 ymax: -6.144973
Geodetic CRS:  WGS 84
    OBJECT_ID KODE_DESA             DESA   KODE    PROVINSI KAB_KOTA
243     25645  31888888     DANAU SUNTER 318888 DKI JAKARTA     &lt;NA&gt;
244     25646  31888888 DANAU SUNTER DLL 318888 DKI JAKARTA     &lt;NA&gt;
    KECAMATAN DESA_KELUR JUMLAH_PEN JUMLAH_KK LUAS_WILAY KEPADATAN
243      &lt;NA&gt;       &lt;NA&gt;          0         0          0         0
244      &lt;NA&gt;       &lt;NA&gt;          0         0          0         0
    PERPINDAHA JUMLAH_MEN PERUBAHAN WAJIB_KTP SILAM KRISTEN KHATOLIK
243          0          0         0         0     0       0        0
244          0          0         0         0     0       0        0
    HINDU BUDHA KONGHUCU KEPERCAYAA PRIA WANITA BELUM_KAWI KAWIN
243     0     0        0          0    0      0          0     0
244     0     0        0          0    0      0          0     0
    CERAI_HIDU CERAI_MATI U0 U5 U10 U15 U20 U25 U30 U35 U40 U45 U50
243          0          0  0  0   0   0   0   0   0   0   0   0   0
244          0          0  0  0   0   0   0   0   0   0   0   0   0
    U55 U60 U65 U70 U75 TIDAK_BELU BELUM_TAMA TAMAT_SD SLTP SLTA
243   0   0   0   0   0          0          0        0    0    0
244   0   0   0   0   0          0          0        0    0    0
    DIPLOMA_I DIPLOMA_II DIPLOMA_IV STRATA_II STRATA_III BELUM_TIDA
243         0          0          0         0          0          0
244         0          0          0         0          0          0
    APARATUR_P TENAGA_PEN WIRASWASTA PERTANIAN NELAYAN AGAMA_DAN
243          0          0          0         0       0         0
244          0          0          0         0       0         0
    PELAJAR_MA TENAGA_KES PENSIUNAN LAINNYA GENERATED KODE_DES_1
243          0          0         0       0      &lt;NA&gt;       &lt;NA&gt;
244          0          0         0       0      &lt;NA&gt;       &lt;NA&gt;
    BELUM_ MENGUR_ PELAJAR_ PENSIUNA_1 PEGAWAI_ TENTARA KEPOLISIAN
243      0       0        0          0        0       0          0
244      0       0        0          0        0       0          0
    PERDAG_ PETANI PETERN_ NELAYAN_1 INDUSTR_ KONSTR_ TRANSP_ KARYAW_
243       0      0       0         0        0       0       0       0
244       0      0       0         0        0       0       0       0
    KARYAW1 KARYAW1_1 KARYAW1_12 BURUH BURUH_ BURUH1 BURUH1_1
243       0         0          0     0      0      0        0
244       0         0          0     0      0      0        0
    PEMBANT_ TUKANG TUKANG_1 TUKANG_12 TUKANG__13 TUKANG__14
243        0      0        0         0          0          0
244        0      0        0         0          0          0
    TUKANG__15 TUKANG__16 TUKANG__17 PENATA PENATA_ PENATA1_1 MEKANIK
243          0          0          0      0       0         0       0
244          0          0          0      0       0         0       0
    SENIMAN_ TABIB PARAJI_ PERANCA_ PENTER_ IMAM_M PENDETA PASTOR
243        0     0       0        0       0      0       0      0
244        0     0       0        0       0      0       0      0
    WARTAWAN USTADZ JURU_M PROMOT ANGGOTA_ ANGGOTA1 ANGGOTA1_1
243        0      0      0      0        0        0          0
244        0      0      0      0        0        0          0
    PRESIDEN WAKIL_PRES ANGGOTA1_2 ANGGOTA1_3 DUTA_B GUBERNUR
243        0          0          0          0      0        0
244        0          0          0          0      0        0
    WAKIL_GUBE BUPATI WAKIL_BUPA WALIKOTA WAKIL_WALI ANGGOTA1_4
243          0      0          0        0          0          0
244          0      0          0        0          0          0
    ANGGOTA1_5 DOSEN GURU PILOT PENGACARA_ NOTARIS ARSITEK AKUNTA_
243          0     0    0     0          0       0       0       0
244          0     0    0     0          0       0       0       0
    KONSUL_ DOKTER BIDAN PERAWAT APOTEK_ PSIKIATER PENYIA_ PENYIA1
243       0      0     0       0       0         0       0       0
244       0      0     0       0       0         0       0       0
    PELAUT PENELITI SOPIR PIALAN PARANORMAL PEDAGA_ PERANG_ KEPALA_
243      0        0     0      0          0       0       0       0
244      0        0     0      0          0       0       0       0
    BIARAW_ WIRASWAST_ LAINNYA_12 LUAS_DESA KODE_DES_3 DESA_KEL_1
243       0          0          0         0       &lt;NA&gt;       &lt;NA&gt;
244       0          0          0         0       &lt;NA&gt;       &lt;NA&gt;
    KODE_12                       geometry
243       0 MULTIPOLYGON (((106.8612 -6...
244       0 MULTIPOLYGON (((106.8504 -6...</code></pre>
</div>
<ul>
<li><p>From the output, we can see that object ID 25645 and 25646 has missing value for the column ‘KAB_KOTA’ and ‘KECAMATAN’ amongst other column</p></li>
<li><p>‘KODE DESA’ format is inconsistent with the other data in the same column</p></li>
</ul>
<p>Hence, we will proceed to drop the two rows with the following code chunk</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DESA_KELUR"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="plotting-the-geospatial-data">6.1.2 Plotting the Geospatial Data</h4>
<p>Let us now quickly visualize the DKI_Jakarta dataframe</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-9-1.png" width="624" /></p>
</div>
<p>From the map, it is evident that DKI_Jakarta consists of outer islands which is not part of our intended study area. We will look into that after we check the projected coordination system.</p>
<h4 id="define-projection">6.1.3 Define Projection</h4>
<ul>
<li><p>The spatial data of Jakarta (Indonesia) is utilised in this analysis.</p></li>
<li><p>Initial data exploration reveals that data is to be projected with the World Geodetic System 1984 datum.</p></li>
<li><p>The corresponding EPSG code is EPSG: 23845.</p></li>
<li><p>The CRS of the data will be checked, then assigned accordingly.</p></li>
<li><p>Unit of measurement will be in metres.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: WGS 84 
  wkt:
GEOGCRS[&quot;WGS 84&quot;,
    DATUM[&quot;World Geodetic System 1984&quot;,
        ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
            LENGTHUNIT[&quot;metre&quot;,1]]],
    PRIMEM[&quot;Greenwich&quot;,0,
        ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    CS[ellipsoidal,2],
        AXIS[&quot;latitude&quot;,north,
            ORDER[1],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        AXIS[&quot;longitude&quot;,east,
            ORDER[2],
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
    ID[&quot;EPSG&quot;,4326]]</code></pre>
</div>
<h4 id="assigning-a-coordinate-system">6.1.4 Assigning a coordinate system</h4>
<p>Although DKI_Jakarta data frame is projected in WGS84 but when we read until the end of the print, it indicates that the EPSG is 4326. This is a wrong EPSG code because the correct EPSG code should be 23845.</p>
<p>In order to assign the correct EPSG code to DKI_Jakarta data frame as well as to set the national projeted coordinates systems of Indonesia whhich is DGN95, st_transform is used as shown in the code chunk below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>st_transform</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, <span class='fl'>23845</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Let us check the CSR again to ensure that changes are reflected</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>st_crs</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Coordinate Reference System:
  User input: EPSG:23845 
  wkt:
PROJCRS[&quot;DGN95 / Indonesia TM-3 zone 54.1&quot;,
    BASEGEOGCRS[&quot;DGN95&quot;,
        DATUM[&quot;Datum Geodesi Nasional 1995&quot;,
            ELLIPSOID[&quot;WGS 84&quot;,6378137,298.257223563,
                LENGTHUNIT[&quot;metre&quot;,1]]],
        PRIMEM[&quot;Greenwich&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433]],
        ID[&quot;EPSG&quot;,4755]],
    CONVERSION[&quot;Indonesia TM-3 zone 54.1&quot;,
        METHOD[&quot;Transverse Mercator&quot;,
            ID[&quot;EPSG&quot;,9807]],
        PARAMETER[&quot;Latitude of natural origin&quot;,0,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8801]],
        PARAMETER[&quot;Longitude of natural origin&quot;,139.5,
            ANGLEUNIT[&quot;degree&quot;,0.0174532925199433],
            ID[&quot;EPSG&quot;,8802]],
        PARAMETER[&quot;Scale factor at natural origin&quot;,0.9999,
            SCALEUNIT[&quot;unity&quot;,1],
            ID[&quot;EPSG&quot;,8805]],
        PARAMETER[&quot;False easting&quot;,200000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8806]],
        PARAMETER[&quot;False northing&quot;,1500000,
            LENGTHUNIT[&quot;metre&quot;,1],
            ID[&quot;EPSG&quot;,8807]]],
    CS[Cartesian,2],
        AXIS[&quot;easting (X)&quot;,east,
            ORDER[1],
            LENGTHUNIT[&quot;metre&quot;,1]],
        AXIS[&quot;northing (Y)&quot;,north,
            ORDER[2],
            LENGTHUNIT[&quot;metre&quot;,1]],
    USAGE[
        SCOPE[&quot;Cadastre.&quot;],
        AREA[&quot;Indonesia - onshore east of 138Â°E.&quot;],
        BBOX[-9.19,138,-1.49,141.01]],
    ID[&quot;EPSG&quot;,23845]]</code></pre>
</div>
<ul>
<li>We have successfully assign DGN95:23845 as the projection for the data.</li>
</ul>
<h4 id="removing-outer-islands">6.1.5 Removing Outer Islands</h4>
<p>To exclude all the outer islands from the DKI_Jakarta dataframe, we will plot an interactive map to identify the mainland.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"view"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>From the initial exploration, it can be found that Object_ID greater than 25383 consists of the island. Hence, we will proceed to filter them out using the code chunk below.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, <span class='va'>OBJECT_ID</span> <span class='op'>&gt;</span> <span class='fl'>25383</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="na-and-geometric-validity-checks">6.1.6 NA and Geometric Validity Checks</h4>
<p>To check if there are any NA values as a result of data manipulation in the previous step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/colSums.html'>rowSums</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span><span class='op'>)</span><span class='op'>!=</span><span class='fl'>0</span>,<span class='op'>]</span>
</code></pre>
</div>
<pre><code>Simple feature collection with 0 features and 161 fields
Bounding box:  xmin: NA ymin: NA xmax: NA ymax: NA
Projected CRS: DGN95 / Indonesia TM-3 zone 54.1
  [1] OBJECT_ID  KODE_DESA  DESA       KODE       PROVINSI  
  [6] KAB_KOTA   KECAMATAN  DESA_KELUR JUMLAH_PEN JUMLAH_KK 
 [11] LUAS_WILAY KEPADATAN  PERPINDAHA JUMLAH_MEN PERUBAHAN 
 [16] WAJIB_KTP  SILAM      KRISTEN    KHATOLIK   HINDU     
 [21] BUDHA      KONGHUCU   KEPERCAYAA PRIA       WANITA    
 [26] BELUM_KAWI KAWIN      CERAI_HIDU CERAI_MATI U0        
 [31] U5         U10        U15        U20        U25       
 [36] U30        U35        U40        U45        U50       
 [41] U55        U60        U65        U70        U75       
 [46] TIDAK_BELU BELUM_TAMA TAMAT_SD   SLTP       SLTA      
 [51] DIPLOMA_I  DIPLOMA_II DIPLOMA_IV STRATA_II  STRATA_III
 [56] BELUM_TIDA APARATUR_P TENAGA_PEN WIRASWASTA PERTANIAN 
 [61] NELAYAN    AGAMA_DAN  PELAJAR_MA TENAGA_KES PENSIUNAN 
 [66] LAINNYA    GENERATED  KODE_DES_1 BELUM_     MENGUR_   
 [71] PELAJAR_   PENSIUNA_1 PEGAWAI_   TENTARA    KEPOLISIAN
 [76] PERDAG_    PETANI     PETERN_    NELAYAN_1  INDUSTR_  
 [81] KONSTR_    TRANSP_    KARYAW_    KARYAW1    KARYAW1_1 
 [86] KARYAW1_12 BURUH      BURUH_     BURUH1     BURUH1_1  
 [91] PEMBANT_   TUKANG     TUKANG_1   TUKANG_12  TUKANG__13
 [96] TUKANG__14 TUKANG__15 TUKANG__16 TUKANG__17 PENATA    
[101] PENATA_    PENATA1_1  MEKANIK    SENIMAN_   TABIB     
[106] PARAJI_    PERANCA_   PENTER_    IMAM_M     PENDETA   
[111] PASTOR     WARTAWAN   USTADZ     JURU_M     PROMOT    
[116] ANGGOTA_   ANGGOTA1   ANGGOTA1_1 PRESIDEN   WAKIL_PRES
[121] ANGGOTA1_2 ANGGOTA1_3 DUTA_B     GUBERNUR   WAKIL_GUBE
[126] BUPATI     WAKIL_BUPA WALIKOTA   WAKIL_WALI ANGGOTA1_4
[131] ANGGOTA1_5 DOSEN      GURU       PILOT      PENGACARA_
[136] NOTARIS    ARSITEK    AKUNTA_    KONSUL_    DOKTER    
[141] BIDAN      PERAWAT    APOTEK_    PSIKIATER  PENYIA_   
[146] PENYIA1    PELAUT     PENELITI   SOPIR      PIALAN    
[151] PARANORMAL PEDAGA_    PERANG_    KEPALA_    BIARAW_   
[156] WIRASWAST_ LAINNYA_12 LUAS_DESA  KODE_DES_3 DESA_KEL_1
[161] KODE_12    geometry  
&lt;0 rows&gt; (or 0-length row.names)</code></pre>
</div>
<h4 id="retain-the-first-nine-fields-in-the-dki-jakarta-sf-data-frame">6.1.7 Retain the first nine fields in the DKI Jakarta sf data frame</h4>
<p>Since we are only interested in the first nine fields of the DKI_Jakarta sf dataframe, we will only retain these columns.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span><span class='op'>[</span>, <span class='fl'>0</span><span class='op'>:</span><span class='fl'>9</span><span class='op'>]</span>
</code></pre>
</div>
</div>
<h4 id="translating-column-name-for-dki_jakarta-to-english">6.1.8 Translating column name for DKI_Jakarta to English</h4>
<p>For convenience and ease of comprehension, we will translate the DKI_Jakarta column names to English by using tidyverse rename function.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>
    Total_Population<span class='op'>=</span><span class='va'>JUMLAH_PEN</span>, Sub_District<span class='op'>=</span><span class='va'>DESA_KELUR</span>, District<span class='op'>=</span><span class='va'>KECAMATAN</span>, 
    City<span class='op'>=</span><span class='va'>KAB_KOTA</span>, Province<span class='op'>=</span><span class='va'>PROVINSI</span>, Village<span class='op'>=</span><span class='va'>DESA</span>, ID<span class='op'>=</span><span class='va'>KODE</span>,
    Village_Code<span class='op'>=</span><span class='va'>KODE_DESA</span>, Object_ID<span class='op'>=</span><span class='va'>OBJECT_ID</span>
    <span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">

</div>
<h3 id="aspatial-data">6.2 Aspatial Data</h3>
<h4 id="understanding-covid_df">6.2.1 Understanding Covid_DF</h4>
<p>To better understand the data structure of Covid_DF, we will inspect it quickly by looking at the first 5 rows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>Covid_DF</span>,<span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>      ID_KEL Nama_provinsi     nama_kota nama_kecamatan
1       &lt;NA&gt;          &lt;NA&gt;          &lt;NA&gt;           &lt;NA&gt;
2 3172051003   DKI JAKARTA JAKARTA UTARA     PADEMANGAN
3 3173041007   DKI JAKARTA JAKARTA BARAT        TAMBORA
4 3175041005   DKI JAKARTA JAKARTA TIMUR    KRAMAT JATI
5 3175031003   DKI JAKARTA JAKARTA TIMUR     JATINEGARA
  nama_kelurahan SUSPEK Perawatan.RS...7 Isolasi.di.Rumah...8
1          TOTAL 717950              197                28717
2          ANCOL    N/A              N/A                  N/A
3          ANGKE    N/A              N/A                  N/A
4   BALE KAMBANG    N/A              N/A                  N/A
5    BALI MESTER    N/A              N/A                  N/A
  Suspek.Meninggal Selesai.Isolasi...10 PROBABLE Perawatan.RS...12
1             2311               686725     7476                95
2              N/A                  N/A      N/A               N/A
3              N/A                  N/A      N/A               N/A
4              N/A                  N/A      N/A               N/A
5              N/A                  N/A      N/A               N/A
  Isolasi.di.Rumah...13 Probable.Meninggal Selesai.Isolasi...15
1                     0               5333                 2048
2                   N/A                N/A                  N/A
3                   N/A                N/A                  N/A
4                   N/A                N/A                  N/A
5                   N/A                N/A                  N/A
  PELAKU.PERJALANAN Perawatan.RS...17 Isolasi.di.Rumah...18
1              4452                 0                     3
2               N/A               N/A                   N/A
3               N/A               N/A                   N/A
4               N/A               N/A                   N/A
5               N/A               N/A                   N/A
  Selesai.Isolasi...19 KONTAK.ERAT Perawatan.RS...21
1                 4449      886591                 0
2                  N/A         N/A               N/A
3                  N/A         N/A               N/A
4                  N/A         N/A               N/A
5                  N/A         N/A               N/A
  Isolasi.di.Rumah...22 Selesai.Isolasi...23 DISCARDED
1                 44028               842563     17463
2                   N/A                  N/A       N/A
3                   N/A                  N/A       N/A
4                   N/A                  N/A       N/A
5                   N/A                  N/A       N/A
  Isolasi.di.Rumah...25 Meninggal...26 Selesai.Isolasi...27 POSITIF
1                     0              1                17462  339735
2                   N/A            N/A                  N/A     834
3                   N/A            N/A                  N/A     617
4                   N/A            N/A                  N/A     755
5                   N/A            N/A                  N/A     358
  Dirawat Sembuh Meninggal...31 Self.Isolation Keterangan
1    4425 323892           5478           5940         NA
2       8    808              9              9         NA
3      23    572              8             14         NA
4       8    698             15             34         NA
5       4    344              8              2         NA
                                                                                                                                                                       Date
1 C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx
2 C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx
3 C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx
4 C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx
5 C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/data/aspatial/Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx
  ID_KEL...1 ID_KEL...2 ODP Proses.Pemantauan Selesai.Pemantauan PDP
1       &lt;NA&gt;       &lt;NA&gt;  NA                NA                 NA  NA
2       &lt;NA&gt;       &lt;NA&gt;  NA                NA                 NA  NA
3       &lt;NA&gt;       &lt;NA&gt;  NA                NA                 NA  NA
4       &lt;NA&gt;       &lt;NA&gt;  NA                NA                 NA  NA
5       &lt;NA&gt;       &lt;NA&gt;  NA                NA                 NA  NA
  Masih.Dirawat Pulang.dan.Sehat Meninggal ODP.Meninggal
1            NA               NA        NA            NA
2            NA               NA        NA            NA
3            NA               NA        NA            NA
4            NA               NA        NA            NA
5            NA               NA        NA            NA
  PDP.Meninggal Isolasi.di.Rumah...21 Selesai.Isolasi...22
1            NA                  &lt;NA&gt;                 &lt;NA&gt;
2            NA                  &lt;NA&gt;                 &lt;NA&gt;
3            NA                  &lt;NA&gt;                 &lt;NA&gt;
4            NA                  &lt;NA&gt;                 &lt;NA&gt;
5            NA                  &lt;NA&gt;                 &lt;NA&gt;
  Isolasi.di.Rumah...24 Meninggal...25 Selesai.Isolasi...26
1                  &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;
2                  &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;
3                  &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;
4                  &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;
5                  &lt;NA&gt;           &lt;NA&gt;                 &lt;NA&gt;
  Meninggal...30 Meninggal...24 Selesai.Isolasi...25 Meninggal...29
1             NA             NA                   NA             NA
2             NA             NA                   NA             NA
3             NA             NA                   NA             NA
4             NA             NA                   NA             NA
5             NA             NA                   NA             NA
  Isolasi.di.Rumah...17 Selesai.Isolasi...18 Isolasi.di.Rumah...20
1                    NA                   NA                    NA
2                    NA                   NA                    NA
3                    NA                   NA                    NA
4                    NA                   NA                    NA
5                    NA                   NA                    NA
  Selesai.Isolasi...21 Meninggal...23 Selesai.Isolasi...24
1                   NA             NA                   NA
2                   NA             NA                   NA
3                   NA             NA                   NA
4                   NA             NA                   NA
5                   NA             NA                   NA
  Meninggal...28 Perawatan.RS Selesai.Isolasi...13
1             NA           NA                   NA
2             NA           NA                   NA
3             NA           NA                   NA
4             NA           NA                   NA
5             NA           NA                   NA
  Isolasi.di.Rumah...15 Selesai.Isolasi...16 Meninggal...21
1                    NA                   NA             NA
2                    NA                   NA             NA
3                    NA                   NA             NA
4                    NA                   NA             NA
5                    NA                   NA             NA</code></pre>
</div>
<p>While combining the different XLSX file into the dataframe, it may have resulted in duplicated columns e.g Meninngal…26, Meninggal…30 which should be consolidated into a single column. Hence, the next step is to remove these duplicated columns and drop the column that we will not use in the analysis.</p>
<h4 id="coalesce-id_kel-meninngal-column">6.2.2 Coalesce ‘ID_KEL’ &amp; ‘Meninngal’ column</h4>
<p>A quick glance at dataframe suggest that there are duplicated ‘ID_KEL’ column. Hence, we can use the coalesce function which finds the first non-missing value at each position to ensure that all the ID are present one single ID column.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>ID_KEL <span class='op'>=</span> <span class='fu'>coalesce</span><span class='op'>(</span><span class='va'>ID_KEL</span>, <span class='va'>ID_KEL...1</span>, <span class='va'>ID_KEL...2</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>We will then repeat this step for the ‘Meninngal’ column. Before we coalesce the various Meninggal column, we will have to change the data type of the column to double as the original column is of different data type.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Meninggal...26</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/double.html'>as.double</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Meninggal...26</span><span class='op'>)</span>

<span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>mutate</span><span class='op'>(</span>Meninggal <span class='op'>=</span> <span class='fu'>coalesce</span><span class='op'>(</span><span class='va'>Meninggal</span>, <span class='va'>Meninggal...28</span>, <span class='va'>Meninggal...29</span>, <span class='va'>Meninggal...30</span>, <span class='va'>Meninggal...31</span>, <span class='va'>Meninggal...26</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="extract-column-of-interest">6.2.3 Extract Column of Interest</h4>
<p>While there are many columns in Covid_DF, the relevant columns for analysis are:</p>
<ul>
<li>Name_provinsi (Province)</li>
<li>name_kota (City)</li>
<li>nama_kecamatan (District)</li>
<li>nama_kelurahan (Sub-district)</li>
<li>Meninggal (Deaths)</li>
<li>POSITIF (Covid Cases)</li>
<li>Date</li>
<li>ID</li>
</ul>
<p>Hence, we will be only be retaining the 8 columns and this is done by selecting these variables by their column name.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='st'>"Date"</span>,<span class='st'>"ID_KEL"</span>, 
                                          <span class='st'>"Nama_provinsi"</span>, <span class='st'>"nama_kota"</span>, 
                                          <span class='st'>"nama_kecamatan"</span>, <span class='st'>"nama_kelurahan"</span>, 
                                          <span class='st'>"POSITIF"</span>, <span class='st'>"Meninggal"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="adding-in-date-column">6.2.4 Adding in ‘Date’ Column</h4>
<p>Since we are interested in the Covid-19 cases in Jakarta through time, it is important to add a ‘Date’ column to identify the Covid-19 cases at different point in time.</p>
<p>A quick look at the XLSX file suggest that a pattern exist in the file names:</p>
<ul>
<li><p>XLSX File Name: Standar Kelurahan Data Corona (28 Februari 2021 Pukul 10.00).xlsx</p></li>
<li><p>The date is formatted as DD-Month-YYY in bracket right before ‘(’ and the word ‘Pukul’</p></li>
<li><p>Hence, we will use regular expressions to extract the date using the following code chunk.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Date</span> <span class='op'>&lt;-</span> <span class='fu'>str_extract</span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Date</span>,<span class='st'>"(?&lt;=Data Corona \\().*(?= Pukul)"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>By looking through Covid_DF, we can see that the month is spelled in Bahasa Indonesia which is the national adminstrative language of Indonesia. With that, we have to set locale to Indonesia and format the date.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/locales.html'>Sys.setlocale</a></span><span class='op'>(</span>locale<span class='op'>=</span><span class='st'>"ind"</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;LC_COLLATE=Indonesian_Indonesia.1252;LC_CTYPE=Indonesian_Indonesia.1252;LC_MONETARY=Indonesian_Indonesia.1252;LC_NUMERIC=C;LC_TIME=Indonesian_Indonesia.1252&quot;</code></pre>
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Date</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Date</span> <span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Date</span> , format <span class='op'>=</span><span class='st'>"%d %B %Y"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="translating-column-name-of-covid_df-to-english">6.2.5 Translating column name of Covid_DF to English</h4>
<p>Next, we will translating column name to English for ease of comprehension using rename()</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/rename.html'>rename</a></span><span class='op'>(</span>
    Death<span class='op'>=</span><span class='va'>Meninggal</span>, Cases<span class='op'>=</span><span class='va'>POSITIF</span>, Sub_District<span class='op'>=</span><span class='va'>nama_kelurahan</span>, 
    District<span class='op'>=</span><span class='va'>nama_kecamatan</span>, City<span class='op'>=</span><span class='va'>nama_kota</span>, Province<span class='op'>=</span><span class='va'>Nama_provinsi</span>, ID<span class='op'>=</span><span class='va'>ID_KEL</span>
  <span class='op'>)</span>
</code></pre>
</div>
</div>
<h4 id="dropping-columns">6.2.6 Dropping Columns</h4>
<p>Quick inspection of Covid_DF dataframe suggest that there are non-numeric data in the “ID” column such as:</p>
<ul>
<li>BELUM DIKETAHUI</li>
<li>PROSES UPDATE DATA</li>
<li>LUAR DKI JAKARTA</li>
</ul>
<p>Hence, we will proceed to drop these rows.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span><span class='va'>Covid_DF</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span>,<span class='op'>]</span>

<span class='va'>Covid_DF</span> <span class='op'>&lt;-</span><span class='va'>Covid_DF</span> <span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"BELUM DIKETAHUI"</span> <span class='op'>|</span> <span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"PROSES UPDATE DATA"</span> <span class='op'>|</span> <span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>==</span><span class='st'>"LUAR DKI JAKARTA"</span><span class='op'>)</span> ,<span class='op'>]</span>
</code></pre>
</div>
</div>
<h2 id="study-area">7. Study Area</h2>
<p>To better understand the study area and Jakarta_Covid dataframe, tmap is used to plot choropleth map to quickly visualize spatial relation of Covid-19 cases and deaths in Jakarta respectively.</p>
<h3 id="joining-the-attribute-data-spatial-data">7.1 Joining the Attribute Data &amp; Spatial Data</h3>
<p>We will use left_join() of dplyr to join the DKI_Jakarta dataframe and Covid_DF dataframe using the following common identifier:</p>
<ul>
<li>Province</li>
<li>Sub-district</li>
<li>City</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid</span> <span class='op'>&lt;-</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, <span class='va'>Covid_DF</span>,
                          by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Province"</span> <span class='op'>=</span> <span class='st'>"Province"</span>,<span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span>,<span class='st'>'City'</span><span class='op'>=</span><span class='st'>'City'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="preliminary-choropleth-map-of-covid-19-cases-in-jakarta">7.2 Preliminary Choropleth Map of Covid-19 Cases in Jakarta</h3>
<p>Next, we will plot the preliminary choropleth map of Covid-19 cases in Jakarta. Note that this map is incomplete and is solely to visualize the geospatial data.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases"</span>,minimize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-28-1.png" width="624" /></p>
</div>
<h3 id="preliminnary-choropleth-map-of-covid-19-death-in-jakarta">7.3 Preliminnary Choropleth Map of Covid-19 Death in Jakarta</h3>
<p>We will repeat the same step for Covid-19 death column.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Death"</span>,minimize <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-29-1.png" width="624" /></p>
</div>
<p>From the two maps, it is evident that there are missing cases and death data. Hence, in the following segment, we will be investigating the reason behind the missing data and determine if additional data cleaning needs to be done.</p>
<h2 id="data-inspection-cleaning-round-2">8. Data Inspection &amp; Cleaning Round 2</h2>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/View.html'>View</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>After inspecting the Jakarta_Covid dataframe, it appears that there are spelling error for data in the ‘Sub-District’ column for DKI_Jakarta and Covid_DF e.g ‘KRAMAJATI’ vs ‘KRAMAT JATI’ which resulted in missing data when joining the aspatial &amp; spatial data.</p>
<h3 id="identifying-missing-sub-district">8.1 Identifying Missing Sub-District</h3>
<p>To establish a systematic way of checking for missing values, we will compare the two data frame - DKI_Jakarta and Covid_DF. The following code chunk will identify the missing ‘sub-district’ value by comparing the two Sub-district column of the two dataframe - Covid_DF and DKI_Jakarkta.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_SD</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>)</span>
<span class='va'>Jakarata_SD</span> <span class='op'>&lt;-</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>$</span><span class='va'>Sub_District</span><span class='op'>)</span>


<span class='va'>Covid_SD</span><span class='op'>[</span><span class='op'>!</span><span class='op'>(</span><span class='va'>Covid_SD</span> <span class='op'>%in%</span> <span class='va'>Jakarata_SD</span><span class='op'>)</span><span class='op'>]</span>
</code></pre>
</div>
<pre><code>  [1] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
  [3] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
  [5] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
  [7] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
  [9] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
 [11] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
 [13] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
 [15] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
 [17] &quot;HALIM PERDANA KUSUMAH&quot; &quot;JATI PULO&quot;            
 [19] &quot;KRAMAT JATI&quot;           &quot;PINANG RANTI&quot;         
 [21] &quot;BALE KAMBANG&quot;          &quot;KALI BARU&quot;            
 [23] &quot;RAWA JATI&quot;             &quot;KAMPUNG TENGAH&quot;       
 [25] &quot;KERENDANG&quot;             &quot;PAL MERIAM&quot;           
 [27] &quot;PULAU HARAPAN&quot;         &quot;PULAU KELAPA&quot;         
 [29] &quot;PULAU PANGGANG&quot;        &quot;PULAU PARI&quot;           
 [31] &quot;PULAU TIDUNG&quot;          &quot;PULAU UNTUNG JAWA&quot;    
 [33] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
 [35] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
 [37] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
 [39] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
 [41] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
 [43] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
 [45] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
 [47] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
 [49] &quot;HALIM PERDANA KUSUMAH&quot; &quot;JATI PULO&quot;            
 [51] &quot;KRAMAT JATI&quot;           &quot;PINANG RANTI&quot;         
 [53] &quot;BALE KAMBANG&quot;          &quot;KALI BARU&quot;            
 [55] &quot;RAWA JATI&quot;             &quot;KAMPUNG TENGAH&quot;       
 [57] &quot;KERENDANG&quot;             &quot;PAL MERIAM&quot;           
 [59] &quot;PULAU HARAPAN&quot;         &quot;PULAU KELAPA&quot;         
 [61] &quot;PULAU PANGGANG&quot;        &quot;PULAU PARI&quot;           
 [63] &quot;PULAU TIDUNG&quot;          &quot;PULAU UNTUNG JAWA&quot;    
 [65] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
 [67] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
 [69] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
 [71] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
 [73] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
 [75] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
 [77] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
 [79] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
 [81] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
 [83] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
 [85] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
 [87] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
 [89] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
 [91] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
 [93] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
 [95] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
 [97] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
 [99] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[101] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[103] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[105] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[107] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[109] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[111] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[113] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[115] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[117] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[119] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[121] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[123] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[125] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[127] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[129] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[131] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[133] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[135] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[137] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[139] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[141] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[143] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[145] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[147] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[149] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[151] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[153] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[155] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[157] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[159] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[161] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[163] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[165] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[167] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[169] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[171] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[173] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[175] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[177] &quot;PINANG RANTI&quot;          &quot;BALE KAMBANG&quot;         
[179] &quot;PAL MERIAM&quot;            &quot;JATI PULO&quot;            
[181] &quot;KALI BARU&quot;             &quot;RAWA JATI&quot;            
[183] &quot;KERENDANG&quot;             &quot;KAMPUNG TENGAH&quot;       
[185] &quot;KRAMAT JATI&quot;           &quot;HALIM PERDANA KUSUMAH&quot;
[187] &quot;P. HARAPAN&quot;            &quot;P. KELAPA&quot;            
[189] &quot;P. PANGGANG&quot;           &quot;P. PARI&quot;              
[191] &quot;P. TIDUNG&quot;             &quot;UNTUNG JAWA&quot;          
[193] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[195] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[197] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[199] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[201] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[203] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[205] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[207] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[209] &quot;HALIM PERDANA KUSUMAH&quot; &quot;JATI PULO&quot;            
[211] &quot;KRAMAT JATI&quot;           &quot;PINANG RANTI&quot;         
[213] &quot;BALE KAMBANG&quot;          &quot;KALI BARU&quot;            
[215] &quot;RAWA JATI&quot;             &quot;KAMPUNG TENGAH&quot;       
[217] &quot;KERENDANG&quot;             &quot;PAL MERIAM&quot;           
[219] &quot;PULAU HARAPAN&quot;         &quot;PULAU KELAPA&quot;         
[221] &quot;PULAU PANGGANG&quot;        &quot;PULAU PARI&quot;           
[223] &quot;PULAU TIDUNG&quot;          &quot;PULAU UNTUNG JAWA&quot;    
[225] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[227] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[229] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[231] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[233] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[235] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[237] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[239] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            
[241] &quot;BALE KAMBANG&quot;          &quot;HALIM PERDANA KUSUMAH&quot;
[243] &quot;JATI PULO&quot;             &quot;KALI BARU&quot;            
[245] &quot;KAMPUNG TENGAH&quot;        &quot;KERENDANG&quot;            
[247] &quot;KRAMAT JATI&quot;           &quot;PAL MERIAM&quot;           
[249] &quot;PINANG RANTI&quot;          &quot;PULAU HARAPAN&quot;        
[251] &quot;PULAU KELAPA&quot;          &quot;PULAU PANGGANG&quot;       
[253] &quot;PULAU PARI&quot;            &quot;PULAU TIDUNG&quot;         
[255] &quot;PULAU UNTUNG JAWA&quot;     &quot;RAWA JATI&quot;            </code></pre>
</div>
<p>From the output, it is evident that the following sub-districts are spelled incorrectly:</p>
<ul>
<li>KRAMATJATI (Correct: ‘KRAMAT JATI’)</li>
<li>PAL MERAH (Correct ‘PALMERAH’)</li>
<li>PALMERIAM (Correct: ‘PAL MERIAM’)</li>
<li>KALIBARU (Correct: ‘KALI BARU’)</li>
<li>RAWAJATI (Correct: ‘RAWA JATI’)</li>
<li>JATIPULO (Correct: ‘JATI PULO’)</li>
<li>KRENDANG (Correct: ‘KERENDANG’)</li>
<li>PINANGRANTI (Correct: ‘PINANG RANTI’)</li>
<li>BALEKAMBANG (Correct: ‘BALE KAMBANG’)</li>
<li>HALIM PERDANA KUSUMA (Correct: HALIM PERDANA KUSAMAH)</li>
<li>KALI DERES (Correct: KALIDERES)</li>
</ul>
<p>Apart from spelling mistakes,there were also sub-districts value that have missing word</p>
<ul>
<li>TENGAH (Correct: ‘KAMPUNG TENGAH’)</li>
</ul>
<h3 id="clean-sub-district-data">8.2 Clean Sub-District Data</h3>
<p>The following code chunk corrects the misspelt sub-district in preparation for joining the attribute data &amp; spatial data in the next step.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"KRAMATJATI"</span>, <span class='st'>"KRAMAT JATI"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"PAL MERAH"</span>, <span class='st'>"PALMERAH"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"PALMERIAM"</span>, <span class='st'>"PAL MERIAM"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"KALIBARU"</span>, <span class='st'>"KALI BARU"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"RAWAJATI"</span>, <span class='st'>"RAWA JATI"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"TENGAH"</span>, <span class='st'>"KAMPUNG TENGAH"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"JATIPULO"</span>, <span class='st'>"JATI PULO"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"KRENDANG"</span>, <span class='st'>"KERENDANG"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"PINANGRANTI"</span>, <span class='st'>"PINANG RANTI"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"BALEKAMBANG"</span>, <span class='st'>"BALE KAMBANG"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='va'>DKI_Jakarta</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>Sub_District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"HALIM PERDANA KUSUMA"</span>, <span class='st'>"HALIM PERDANA KUSUMAH"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>Covid_DF</span><span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'>mutate</span><span class='op'>(</span>District <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>District</span><span class='op'>)</span> <span class='op'>==</span> <span class='st'>"KALI DERES"</span>, <span class='st'>"KALIDERES"</span>, <span class='fu'><a href='https://rdrr.io/r/base/character.html'>as.character</a></span><span class='op'>(</span><span class='va'>District</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="joining-the-attribute-data-spatial-data-1">8.3 Joining the Attribute Data &amp; Spatial Data</h3>
<p>To check the sub_district data, we will have to use left_join() of dplyr to join the DKI_Jakarta dataframe and Covid_DF dataframe again using common identifier which is ‘sub_district’</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid</span> <span class='op'>&lt;-</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, <span class='va'>Covid_DF</span>,
                          by <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="checking-sub-district-data">8.4 Checking Sub-District Data</h3>
<p>Plotting the cases against the map of Jakarta to verify that all the misspelled sub-district and district are corrected.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases"</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-34-1.png" width="624" /></p>
</div>
<ul>
<li>From the output, we can see that all the sub-district data are now corrected.</li>
</ul>
<h2 id="writing-and-reading-rds">9. Writing and Reading RDS</h2>
<h3 id="writing-rds">9.1 Writing RDS</h3>
<p>Next, we will use the write_rds() function to export the data frame.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>write_rds</span><span class='op'>(</span><span class='va'>Covid_DF</span>, file <span class='op'>=</span><span class='st'>"Covid_DF.rds"</span><span class='op'>)</span>
<span class='fu'>write_rds</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, file <span class='op'>=</span><span class='st'>"DKI_Jakarta.rds"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="read-rds">9.2 Read RDS</h3>
<p>Afterwhich, we will read the RDS.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"/data/rds/Covid_DF.rds"</span><span class='op'>)</span>
<span class='va'>DKI_Jakarta</span> <span class='op'>&lt;-</span> <span class='fu'>read_rds</span><span class='op'>(</span><span class='st'>"/data/rds/DKI_Jakarta.rds"</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h2 id="exploratory-data-analysis">10. Exploratory Data Analysis</h2>
<p>Before moving on to thematic mapping, we will quickly calculate the cumulative case rate to better understand the trend over time.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Case_Rate</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Cuml_Case_Rate` <span class='op'>=</span>  <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Total_Population</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>pivot_wider</span><span class='op'>(</span>names_from <span class='op'>=</span> <span class='va'>Date</span>,
              values_from <span class='op'>=</span> <span class='va'>Cuml_Case_Rate</span><span class='op'>)</span>


<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>Case_Rate</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code> Sub_District         2020-03-31        2020-04-30    
 Length:261         Min.   : 0.0000   Min.   : 0.000  
 Class :character   1st Qu.: 0.0000   1st Qu.: 1.393  
 Mode  :character   Median : 0.3264   Median : 2.220  
                    Mean   : 0.7609   Mean   : 3.370  
                    3rd Qu.: 0.6928   3rd Qu.: 4.016  
                    Max.   :49.8826   Max.   :49.883  
   2020-05-31       2020-06-30        2020-07-31     
 Min.   : 0.000   Min.   :  0.000   Min.   :  1.518  
 1st Qu.: 2.646   1st Qu.:  4.179   1st Qu.:  7.477  
 Median : 4.198   Median :  6.515   Median : 10.690  
 Mean   : 5.458   Mean   :  8.728   Mean   : 14.002  
 3rd Qu.: 6.796   3rd Qu.: 10.631   3rd Qu.: 15.758  
 Max.   :49.883   Max.   :105.336   Max.   :112.243  
   2020-08-31        2020-09-30        2020-10-31    
 Min.   :  2.429   Min.   :  6.681   Min.   : 13.82  
 1st Qu.: 14.134   1st Qu.: 32.867   1st Qu.: 54.17  
 Median : 19.532   Median : 41.312   Median : 64.34  
 Mean   : 25.203   Mean   : 51.530   Mean   : 76.97  
 3rd Qu.: 31.381   3rd Qu.: 58.183   3rd Qu.: 85.28  
 Max.   :210.492   Max.   :511.658   Max.   :605.57  
   2020-11-30       2020-12-31        2021-02-28    
 Min.   : 28.85   Min.   :  42.06   Min.   :  75.2  
 1st Qu.: 75.33   1st Qu.: 106.54   1st Qu.: 217.0  
 Median : 88.97   Median : 124.56   Median : 256.6  
 Mean   :103.09   Mean   : 142.66   Mean   : 280.1  
 3rd Qu.:110.95   3rd Qu.: 152.73   3rd Qu.: 309.5  
 Max.   :783.68   Max.   :1036.27   Max.   :1632.1  
   2021-03-31        2021-04-30        2021-05-31     
 Min.   :  83.71   Min.   :  90.04   Min.   :  91.88  
 1st Qu.: 247.10   1st Qu.: 264.21   1st Qu.: 276.21  
 Median : 294.83   Median : 315.17   Median : 333.16  
 Mean   : 318.40   Mean   : 342.78   Mean   : 362.22  
 3rd Qu.: 348.82   3rd Qu.: 372.94   3rd Qu.: 391.92  
 Max.   :1839.38   Max.   :2014.25   Max.   :2075.78  
   2021-06-30       2021-07-31    
 Min.   : 119.4   Min.   : 187.3  
 1st Qu.: 360.0   1st Qu.: 545.1  
 Median : 423.9   Median : 658.3  
 Mean   : 465.3   Mean   : 705.3  
 3rd Qu.: 503.4   3rd Qu.: 779.7  
 Max.   :2726.7   Max.   :3808.3  </code></pre>
</div>
<ul>
<li><p>Based on summary statistics, there is generally an increase in the number of COVID-19 cases in Jakarta with time between March 2020 and July 2021 , as observed from the increasing mean COVID-19 case rates across the months.</p></li>
<li><p>Over time, we can also start to growing differences (range) in cumulative case rate between the maximum and minimum value.</p></li>
<li><p>From the statistic alone, it can be inferred that there are sub-district in Jakarta with zero COVID-19 cases till 30 June 2020.</p></li>
</ul>
<p>To explore the spatial relationship between Covid-19 case rate and sub-district in Jakarta, we will move on to the next segment on thematic mapping.</p>
<h2 id="thematic-mapping">11. Thematic Mapping</h2>
<p>To better understand the spatio-temporal distribution of COVID-19 at the sub_district level, choropleth mapping techniques will be utilised for the analysis.</p>
<p>Choropleth maps visualising the spatial distribution of COVID-19 rates across sub_district in Jakarta, will be plotted across time (March 2020 to July 2021). Covid Cases Per 10k Population will be visualised instead of the number of COVID-19 cases to standardised population sizes for a more holistic comparison.</p>
<h4 id="cumulative-confirmed-cases">11.1 Cumulative Confirmed Cases</h4>
<h5 id="data-preparation">11.1.1 Data preparation</h5>
<p>The following code chunk will use left_join() of dplyr to join the geographical data (DKI_Jakarta) and attribute table (Covid_DF) using sub-district as the common identifier.</p>
<p>Following which, it will be group by sub-district and date as we are interested to see the change in COVID-19 case rate over time at sub-district level.</p>
<p>Finally, the cumulative confirmed cases per 10,0000 population will be calculated using summarise function of dplyr using the following formula:</p>
<p><span class="math display">\[ Monthly\ Cumulative\ Confirmed\ Cases\  = 
\frac{Total\ no\ of\ Covid-19\ cases\ at\ Sub-District\ 
Level}{Total\ Population\ of\ the\ Sub-District} \ *\ 10,000\]</span></p>
<p>After which, we will then covert Jakarta_Covid_Cases into sf.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid_Cases</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Cases Per 10k Population` <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Total_Population</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_Cases</span> <span class='op'>&lt;-</span> <span class='va'>Jakarta_Covid_Cases</span><span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, 
                       by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_Cases</span><span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="plotting-choropleth-map-of-monthly-cumulative-confirmed-cases">11.1.2 Plotting Choropleth Map of Monthly Cumulative Confirmed Cases</h5>
<p><em>Classification Method</em></p>
<p>Custom breaks will have to be specified explicitly to construct the classification scheme for Covid Cases Per 10k Population.</p>
<p>To guide the specification of breakpoints, descriptive statistics of Covid Cases Per 10k Population across months are first computed and studied.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases</span><span class='op'>[</span><span class='st'>"Cases Per 10k Population"</span><span class='op'>]</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code> Cases Per 10k Population          geometry   
 Min.   :   0.000         MULTIPOLYGON :4176  
 1st Qu.:   9.169         epsg:23845   :   0  
 Median :  81.846         +proj=tmer...:   0  
 Mean   : 181.618                             
 3rd Qu.: 295.391                             
 Max.   :3808.290                             </code></pre>
</div>
<ul>
<li>It can be observed that Covid Cases Per 10k Population rate range from 0 to 3808 across sub district, from March 2020 to July 2021.</li>
</ul>
<p><em>Break Point</em></p>
<p>To choose an appropriate number of classes, we will use the sturges formula <span class="math display">\[ No\ of\ Classes = 1 + 1.32 * Log (Number\ of \ Values)\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Classes</span><span class='op'>=</span><span class='fl'>1</span><span class='op'>+</span> <span class='fl'>1.32</span><span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>4176</span><span class='op'>)</span>
<span class='va'>Classes</span>
</code></pre>
</div>
<pre><code>[1] 12.00498</code></pre>
</div>
<p>Taking into account the result and considering legibility, we will set the number of classes to be 7</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Classes</span><span class='op'>=</span><span class='fl'>1</span><span class='op'>+</span> <span class='fl'>1.32</span><span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>4176</span><span class='op'>)</span>
<span class='va'>Classes</span>
</code></pre>
</div>
<pre><code>[1] 12.00498</code></pre>
</div>
<p>In the code chunk below, tm_shape() is used to define the input data (Jakarta_Covid_Cases) and tm_fill() is used to illustrate the monthly cumulative confirmed cases at sub-district level.</p>
<p>The choropleth map is plotted with custom classification scheme for the month of March 2020, as this was the first month which COVID-19 was first detected in Jakarta.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid_Cases_March</span> <span class='op'>&lt;-</span> <span class='va'>Jakarta_Covid_Cases</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2020-03-31"</span><span class='op'>)</span>


<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>13</span>, <span class='fl'>53</span>, <span class='fl'>119</span>, <span class='fl'>270</span>, <span class='fl'>395</span>, <span class='fl'>3808</span><span class='op'>)</span>, 
legend.is.portrait <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='st'>"Cumulative Confirmed Cases per 10,000 population \n of Jakarta sub-district - March 2020"</span> ,
            main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
            main.title.size <span class='op'>=</span> <span class='fl'>3.0</span>,title.size <span class='op'>=</span> <span class='fl'>3.00</span>,
            legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.title.size <span class='op'>=</span> <span class='fl'>2.90</span>, legend.text.size <span class='op'>=</span> <span class='fl'>2.60</span>,
            legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.15</span>,text.size <span class='op'>=</span> <span class='fl'>1.50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>2.00</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-43-1.png" width="2496" /></p>
</div>
<ul>
<li><p>A darker shade of oranange indicates a higher COVID-19 rate per 10k population.</p></li>
<li><p>From the choropleth map, it can observe that in March 2020, the sub-district with about 13 to 53 cases is around south-west Jakarta, specifically the sub-district Senayan</p></li>
<li><p>It is also interesting to note that sub_district near Senayan such as Gelora and Karet Semmangi, Rawa Barat also appears to have a slightly higher COVID-19 rate per 10k population compared to other sub-district.</p></li>
</ul>
<h5 id="time-series-choropleth-map-of-covid-19-rates">11.1.3 Time-series choropleth map of COVID-19 Rates</h5>
<p>For this segment, we hope to see the spatial-temporal patterns of COVID-19 case in DKI Jakarta between March 2020 to July 2021.</p>
<p>Again, tm_shape() is used to define the input data (Jakarta_Covid_Cases) and tm_fill() is used to illustrate the monthly cumulative confirmed cases at sub-district level. Tm_facet() will be used to specify facets (small multiples) which will group the data by time period of the COVID-19 case rate.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>13</span>, <span class='fl'>53</span>, <span class='fl'>119</span>, <span class='fl'>270</span>, <span class='fl'>395</span>, <span class='fl'>3808</span><span class='op'>)</span>,
          thres.poly <span class='op'>=</span> <span class='fl'>0</span>,palette <span class='op'>=</span> <span class='st'>"Reds"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_facets</span><span class='op'>(</span>by<span class='op'>=</span><span class='st'>"Date"</span>, 
            free.coords<span class='op'>=</span><span class='cn'>TRUE</span>, 
            drop.shapes<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.show <span class='op'>=</span> <span class='cn'>TRUE</span>,
            title.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"center"</span>, <span class='st'>"center"</span><span class='op'>)</span>, 
            main.title.size <span class='op'>=</span> <span class='fl'>4</span>,main.title <span class='op'>=</span> <span class='st'>"Cumulative Covid-19 Rate In Jakarta Sub-District"</span>, legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.width <span class='op'>=</span> <span class='fl'>0.70</span>, legend.text.size <span class='op'>=</span> <span class='fl'>1.80</span>, legend.title.size <span class='op'>=</span> <span class='fl'>1.80</span>, legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>, panel.label.size <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.11</span>,text.size <span class='op'>=</span> <span class='fl'>1.80</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>1.50</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-45-1.png" width="1920" /></p>
</div>
<ul>
<li><p>It can be observed that COVID-19 cases seem to spread outwards to the neighbouring sub-district with time.</p></li>
<li><p>In the first 3 month (Mar 2020 - May 2020), it appears that COVID-19 cases are mostly concentrated around central and western Jakarta.</p></li>
<li><p>By August 2020, sub-district with the highest COVID-19 cases per 10k population (darker red areas) are mostly found in central jakarta</p></li>
<li><p>In the first half of 2021, COVID-19 cases per 10k population appears to spread throughout Jakarta. However, it is to noted that due to the large class interval of 395 to 3808, difference between the various sub_district may not be apparently from April 2021 onwards.</p></li>
<li><p>On the whole, COVID-19 case rate increases across sub-district through time.</p></li>
</ul>
<h5 id="animated-time-series-choropleth-map-of-covid-19-rates">11.1.4 Animated Time-series choropleth map of COVID-19 Rates</h5>
<p>To better visualize the changes across the various sub-district through time, we will plot an animated map with the same data using the tmap_animation() function to better visualize the changes in sub-district through time.</p>
<p>The output will be saved in gif format.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covd_Cases_Animation</span><span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Cases Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>4</span>, <span class='fl'>13</span>, <span class='fl'>53</span>, <span class='fl'>119</span>, <span class='fl'>270</span>, <span class='fl'>395</span>, <span class='fl'>3808</span><span class='op'>)</span> ,palette <span class='op'>=</span> <span class='st'>"Reds"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='fu'>tm_facets</span><span class='op'>(</span>along <span class='op'>=</span> <span class='st'>"Date"</span>, free.coords <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  
<span class='fu'>tmap_animation</span><span class='op'>(</span><span class='va'>Covd_Cases_Animation</span>,file<span class='op'>=</span><span class='st'>"C:/Users/User/Desktop/IS415/lye-jia-wei/IS415_blog/_posts/2021-08-30-take-home-exercise-1/AnimatedMap/Covid_Case_Animation.gif"</span> , delay <span class='op'>=</span> <span class='fl'>45</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><em>Cumulative Confirmed Cases per 10k population In Jakarta Sub-District From Mar 2020 - Jul 2021</em></p>
<p><img src="AnimatedMap/Covid_Case_Animation.gif" /></p>
<h4 id="cumulative-covid-19-death">11.2 Cumulative Covid-19 Death</h4>
<h5 id="data-preparation-1">11.2.1 Data Preparation</h5>
<p>After understanding the COVID-19 case rate, we will now look into the death rate at sub-district level.</p>
<p>The following code chunk will use left_join() of dplyr to join the geographical data (DKI_Jakarta) and attribute table (Covid_DF) using sub-district as the common identifier.</p>
<p>Following which, it will be group by sub-district and date and we will calculate the cumulative death per 10,0000 population using summarise function of dplyr with the following formula:</p>
<p><span class="math display">\[ Monthly\ Cumulative\ Confirmed\ Death\  = 
\frac{Total\ no\ of\ Covid-19\ Death\ at\ Sub-District\ 
Level}{Total\ Population\ of\ the\ Sub-District} *\ 10,000\]</span></p>
<p>After which, we will then covert Jakarta_Covid_Cases into sf.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Death</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span>
  <span class='fu'>inner_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Death Per 10k Population` <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Death</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Total_Population</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>*</span> <span class='fl'>10000</span><span class='op'>)</span>  <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>

<span class='va'>Jakarta_Death</span>  <span class='op'>&lt;-</span> <span class='va'>Jakarta_Death</span> <span class='op'>%&gt;%</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, 
                       by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>Jakarta_Death</span> <span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Jakarta_Death</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="plotting-choropleth-map-of-monthly-cumulative-death">11.2.2 Plotting Choropleth Map of Monthly Cumulative Death</h5>
<p><em>Classification Method</em></p>
<p>Custom breaks will have to be specified explicitly to construct the classification scheme for Covid Death Per 10k Population.</p>
<p>To guide the specification of breakpoints, descriptive statistics of Covid Death Per 10k Population across months is first computed and studied.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>Jakarta_Death</span><span class='op'>[</span><span class='st'>"Death Per 10k Population"</span><span class='op'>]</span><span class='op'>)</span> 
</code></pre>
</div>
<pre><code> Death Per 10k Population          geometry   
 Min.   : 0.0000          MULTIPOLYGON :4176  
 1st Qu.: 0.4592          epsg:23845   :   0  
 Median : 1.8004          +proj=tmer...:   0  
 Mean   : 3.1676                              
 3rd Qu.: 5.1803                              
 Max.   :42.0984                              </code></pre>
</div>
<ul>
<li>It can be observed that Covid Death Per 10k population rate range from 0 to 42 across sub district, from March 2020 to July 2021.</li>
</ul>
<p><em>Break Point</em></p>
<p>To choose an appropriate number of classes, we will use the sturges formula <span class="math display">\[ No\ of\ Classes = 1 + 1.32 * Log (Number\ of \ Values)\]</span></p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Classes</span><span class='op'>=</span><span class='fl'>1</span><span class='op'>+</span> <span class='fl'>1.32</span><span class='op'>*</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span><span class='op'>(</span><span class='fl'>4176</span><span class='op'>)</span>
<span class='va'>Classes</span>
</code></pre>
</div>
<pre><code>[1] 12.00498</code></pre>
</div>
<p>With the result and considering legibility, we will set the number of classes to be 7</p>
<p>The choropleth map is plotted with custom classification scheme. To compare with the previous map, we will also filter the date to be March 2020.</p>
<p>tm_shape() is used to define the input data (Jakarta_Death) and tm_fill() is used to illustrate the monthly cumulative death at sub-district level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Death_March</span> <span class='op'>&lt;-</span> <span class='va'>Jakarta_Death</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2020-03-31"</span><span class='op'>)</span>

<span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Death_March</span><span class='op'>)</span><span class='op'>+</span>
<span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Death Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>0</span>, <span class='fl'>2</span>, <span class='fl'>4</span>, <span class='fl'>6</span>, <span class='fl'>8</span>, <span class='fl'>10</span>, <span class='fl'>12</span>, <span class='fl'>14</span><span class='op'>)</span>, 
legend.is.portrait <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
<span class='fu'>tm_layout</span><span class='op'>(</span>legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.title.size <span class='op'>=</span> <span class='fl'>3.10</span>, legend.text.size <span class='op'>=</span> <span class='fl'>2.90</span>,
            legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span>, main.title <span class='op'>=</span> <span class='st'>"Cumulative Death per 10k population in Jakarta Sub-district(Mar 2020)"</span>, main.title.size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>8</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.15</span>,text.size <span class='op'>=</span> <span class='fl'>1.50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>2.00</span><span class='op'>)</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-51-1.png" width="2496" /></p>
</div>
<ul>
<li>From the map, it can be seen that Gondangdia and Senayan are the only 2 sub-district with about 2 to 4 Covid death in March 2020.</li>
</ul>
<h5 id="time-series-choropleth-map-of-covid-19-rates-1">11.2.3 Time-series choropleth map of COVID-19 Rates</h5>
<p>By using tm_facet() and grouping by date in tm_facets(), we can see the spatial-temporal patterns of COVID-19 death in DKI Jakarta between March 2020 to July 2021.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Death</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Death Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>8</span>, <span class='fl'>12</span>, <span class='fl'>16</span>, <span class='fl'>20</span>, <span class='fl'>24</span>, <span class='fl'>28</span>, <span class='fl'>32</span><span class='op'>)</span>,
          thres.poly <span class='op'>=</span> <span class='fl'>0</span>,palette <span class='op'>=</span> <span class='st'>"Reds"</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_facets</span><span class='op'>(</span>by<span class='op'>=</span><span class='st'>"Date"</span>, 
            free.coords<span class='op'>=</span><span class='cn'>TRUE</span>, 
            drop.shapes<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.show <span class='op'>=</span> <span class='cn'>TRUE</span>, title.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"center"</span>, <span class='st'>"center"</span><span class='op'>)</span>, main.title.size <span class='op'>=</span> <span class='fl'>4</span>, main.title <span class='op'>=</span> <span class='st'>"   Cumulative Covid-19 Death Rate In Jakarta Sub-District"</span>,  legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.width <span class='op'>=</span> <span class='fl'>0.70</span>, legend.text.size <span class='op'>=</span> <span class='fl'>1.80</span>, legend.title.size <span class='op'>=</span> <span class='fl'>1.80</span>, legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>, panel.label.size <span class='op'>=</span> <span class='fl'>2.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.10</span>,text.size <span class='op'>=</span> <span class='fl'>1.80</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>1.50</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-53-1.png" width="1920" /></p>
</div>
<ul>
<li><p>From the map, it is evident that despite the high covid case per 10k population shown earlier, there is a stark contrast with the map depicitng covid death per 10k population. This may suggest that Covid-19 death rate is relatively low in the earlier period when COVID-19 was spreading in Jakarta sub-district e.g March 2020 to Dec 2020</p></li>
<li><p>By Feb 2021, one particular sub-district, Gambir, stood out as it is the only sub-district with a relatively high (28-32) death per 10k population</p></li>
<li><p>Death per 10k population increases sharply after May 2021 and appears to be higher in Central Jakarta. The sharp rise in death per 10k population may be a result of the more fatal Covid-19 Delta variant, though additional statistical testing needs to be conducted to prove this hypothesis.</p></li>
</ul>
<h5 id="animated-time-series-choropleth-map-of-covid-19-rates-1">11.2.4 Animated Time-series choropleth map of COVID-19 Rates</h5>
<p>To better visualize the changes in death rate across the various sub-district through time, we will plot an animated map with the same data using tmap_animation().</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covd_Death_Animation</span> <span class='op'>=</span> <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Death</span><span class='op'>)</span><span class='op'>+</span> <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Death Per 10k Population"</span>, breaks <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>4</span>, <span class='fl'>8</span>, <span class='fl'>12</span>, <span class='fl'>16</span>, <span class='fl'>20</span>, <span class='fl'>24</span>, <span class='fl'>28</span>, <span class='fl'>32</span><span class='op'>)</span> ,palette <span class='op'>=</span> <span class='st'>"Reds"</span><span class='op'>)</span> <span class='op'>+</span>  <span class='fu'>tm_facets</span><span class='op'>(</span>along <span class='op'>=</span> <span class='st'>"Date"</span>, free.coords <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
  
  
<span class='fu'>tmap_animation</span><span class='op'>(</span><span class='va'>Covd_Death_Animation</span>, delay <span class='op'>=</span> <span class='fl'>45</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p><em>Cumulative Death Rate In Jakarta Sub-District From Mar 2020 - Jul 2021</em></p>
<p><img src="AnimatedMap/Covd_Death_Animation.gif" /></p>
<h2 id="analytical-map">12. Analytical Map</h2>
<h3 id="barchart">12.1 Barchart</h3>
<p>To better understand specific sub-district which has been affected by COVID-19 the most in terms of infection rate and death rate, we will now proceed to plot bar chart that shows the top 10 district with highest Covid-19 case rate and death rate from March 2020 to July 2021.</p>
<h4 id="bar-chart-of-top-10-sub-district-with-highest-covid-19-cases-per-10000-population">12.1.1 Bar Chart of Top 10 Sub-District With Highest Covid-19 Cases Per 10,000 Population</h4>
<h5 id="combining-aspatial-and-spatial-dataframe">12.1.1.1 Combining aspatial and spatial dataframe</h5>
<p>First, we will filter to the most recent date which is July 2021.</p>
<p>Again, we will combine the Covid_DF and DKI_Jakarta data frame by common identifier ‘Sub_District’ using the left_join() of dplyr. We will use the aforementioned formula to calculate the Covid cases per 10,000 population and it will be named as ‘Covid_Case_10K’.</p>
<p>Note that this time round, we will only group by sub-district as we are interested to find out the overall case rate at sub-district level.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF_2</span><span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2021-07-31"</span><span class='op'>)</span>
<span class='va'>Jakarta_Covid_Sub_District</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF_2</span> <span class='op'>%&gt;%</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Covid_Case_10k` <span class='op'>=</span><span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Total_Population</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="dropping-duplicated-rows-and-rounding-up">12.1.1.2 Dropping Duplicated Rows and Rounding Up</h5>
<p>Next, we will get drop the duplicated row as well as to round the result to nearest number.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid_Sub_District</span> <span class='op'>&lt;-</span><span class='va'>Jakarta_Covid_Sub_District</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Sub_District</span><span class='op'>)</span>, <span class='op'>]</span>

<span class='va'>Jakarta_Covid_Sub_District</span><span class='op'>$</span><span class='va'>Covid_Case_10k</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Sub_District</span><span class='op'>$</span><span class='va'>Covid_Case_10k</span> ,<span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="plotting-barchart">12.1.1.3 Plotting barchart</h5>
<p>Following which, we will sort the sub_district by covid cases per 10k population and only plot the bar chart for the top 10 sub_district with highest covid cases using ggplot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>top_n</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Sub_District</span>, n<span class='op'>=</span><span class='fl'>10</span>, <span class='va'>Covid_Case_10k</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Covid_Case_10k</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Covid_Case_10k</span><span class='op'>)</span>,label<span class='op'>=</span> <span class='op'>(</span><span class='va'>Covid_Case_10k</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
              <span class='fu'>geom_bar</span><span class='op'>(</span>stat<span class='op'>=</span><span class='st'>'identity'</span><span class='op'>)</span><span class='op'>+</span> 
  <span class='fu'>geom_col</span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>'darksalmon'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>'Top 10 Sub-District With Highest Covid-19 Case Rate'</span>,
       x<span class='op'>=</span><span class='st'>'Cases per 10k'</span>,
       y<span class='op'>=</span><span class='st'>'Sub-District'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>nudge_x<span class='op'>=</span><span class='op'>-</span><span class='fl'>115.85</span>,vjust <span class='op'>=</span> <span class='fl'>0.5</span>, colour<span class='op'>=</span><span class='st'>'gray23'</span>, size<span class='op'>=</span><span class='fl'>2.87</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-57-1.png" width="624" /></p>
</div>
<ul>
<li><p>From the barchart, we can see that Gambir is the sub district with the highest Covid-19 cases per 10k population in Jakarta between March 2020 and July 2021.</p></li>
<li><p>To note that the top 3 sub-districted highlighted in the barchart are located close to each other as seen from the Choropleth map. We will study the geospatial relationship further in the later part of the analysis.</p></li>
</ul>
<h4 id="bar-chart-of-top-10-sub-district-with-highest-covid-19-death-per-10000-population">12.1.2 Bar Chart of Top 10 Sub-District With Highest Covid-19 Death Per 10,000 Population</h4>
<h5 id="combining-aspatial-and-spatial-dataframe-1">12.1.2.1 Combining aspatial and spatial dataframe</h5>
<p>Again, we will combine the Covid_DF and DKI_Jakarta data frame by common identifier ‘Sub_District’. We will use the same formula to calculate the Covid death per 10,000 population and it will be named as ‘Death_Per_10K’.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Death_Sub_District</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF_2</span> <span class='op'>%&gt;%</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>%&gt;%</span> 
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Death_Per_10k <span class='op'>=</span> <span class='op'>(</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Death</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='va'>Total_Population</span> <span class='op'>)</span><span class='op'>)</span><span class='op'>*</span><span class='fl'>10000</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="dropping-duplicated-rows-and-rounding-up-1">12.1.2.2 Dropping duplicated rows and Rounding Up</h5>
<p>Next, we will get drop the duplicated row and round the result to nearest number.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Death_Sub_District</span> <span class='op'>&lt;-</span><span class='va'>Jakarta_Death_Sub_District</span><span class='op'>[</span><span class='op'>!</span><span class='fu'><a href='https://rdrr.io/r/base/duplicated.html'>duplicated</a></span><span class='op'>(</span><span class='va'>Jakarta_Death_Sub_District</span><span class='op'>)</span>, <span class='op'>]</span>

<span class='va'>Jakarta_Death_Sub_District</span><span class='op'>$</span><span class='va'>Death_Per_10k</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>round</a></span><span class='op'>(</span><span class='va'>Jakarta_Death_Sub_District</span><span class='op'>$</span><span class='va'>Death_Per_10k</span> ,<span class='fl'>0</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="bar-chart">12.1.2.3 Bar Chart</h5>
<p>Following which, we will sort the sub_district by COVID-19 death per 10k population and only plot the top 10 sub_district with highest COVID-19 death using ggplot.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>top_n</span><span class='op'>(</span><span class='va'>Jakarta_Death_Sub_District</span>, n<span class='op'>=</span><span class='fl'>10</span>, <span class='va'>Death_Per_10k</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
          <span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>.</span>, <span class='fu'>aes</span><span class='op'>(</span>x<span class='op'>=</span><span class='va'>Death_Per_10k</span>, y<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/stats/reorder.factor.html'>reorder</a></span><span class='op'>(</span><span class='va'>Sub_District</span>, <span class='va'>Death_Per_10k</span><span class='op'>)</span>,label<span class='op'>=</span> <span class='op'>(</span><span class='va'>Death_Per_10k</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
              <span class='fu'>geom_bar</span><span class='op'>(</span>stat<span class='op'>=</span><span class='st'>'identity'</span><span class='op'>)</span><span class='op'>+</span> 
  <span class='fu'>geom_col</span><span class='op'>(</span>fill<span class='op'>=</span><span class='st'>'darksalmon'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title<span class='op'>=</span><span class='st'>'Top 10 Sub-District With Highest Covid-19 Death'</span>,
       x<span class='op'>=</span><span class='st'>'Death per 10k'</span>,
       y<span class='op'>=</span><span class='st'>'Sub-District'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_text</span><span class='op'>(</span>nudge_x<span class='op'>=</span><span class='op'>-</span><span class='fl'>0.85</span>,vjust <span class='op'>=</span> <span class='fl'>0.5</span>, colour<span class='op'>=</span><span class='st'>'gray23'</span>, size<span class='op'>=</span><span class='fl'>2.87</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span> <span class='fu'>theme</span><span class='op'>(</span>plot.title <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>size<span class='op'>=</span><span class='fl'>10</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-60-1.png" width="624" /></p>
</div>
<ul>
<li><p>As pointed out previously in the Choropleth map, Gambir has one of the highest Covid-19 death per 10k population</p></li>
<li><p>Again, we can observe that the top sub-district with highest Covid-19 death per 10k population appears to be geographically near to one another as pointed out in earlier analysis</p></li>
<li><p>To note, the top 10 district with highest Covid-19 cases and Covid-19 death per 10k population differs slightly.</p></li>
</ul>
<h3 id="box-map">12.2 Box Map</h3>
<p>A box map will be used to visualise covid cases spatially across different sub-district in Jakarta.</p>
<p>A customised classification scheme for the choropleth map will be constructed using the basic principles of a box plot.This ensures that data classification is not manipulated, and that the data is visualised accurately to represent the real-world situation. The box map will enable statistical interpretation of outliers and better identification of subzones that have relatively higher or lower demand compared to the rest of the subzones. In this analysis, data points will be considered outliers if they are more than 1.5 times interquartile range.</p>
<p>The following code chunks are functions to construct the box map which consist of</p>
<ul>
<li>boxbreaks to create break points for box map</li>
<li>get.var to extract variable as vector out of dataframe</li>
<li>Boxmap function with points overlayed on top of choropleth map</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='co'># To create break points for box map</span>

<span class='va'>boxbreaks</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>v</span>, <span class='va'>mult</span><span class='op'>=</span><span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>qv</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span><span class='op'>)</span>
  <span class='va'>iqr</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span>
  <span class='co'># upfence and lofence define the area where points will be defined as outliers</span>
  <span class='va'>upfence</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>4</span><span class='op'>]</span> <span class='op'>+</span> <span class='va'>mult</span> <span class='op'>*</span> <span class='va'>iqr</span>
  <span class='va'>lofence</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>-</span> <span class='va'>mult</span> <span class='op'>*</span> <span class='va'>iqr</span>
  <span class='co'># initialize break points vector</span>
  <span class='va'>bb</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/vector.html'>vector</a></span><span class='op'>(</span>mode<span class='op'>=</span><span class='st'>"numeric"</span>,length<span class='op'>=</span><span class='fl'>7</span><span class='op'>)</span>
  <span class='co'># logic for lower and upper fences</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>lofence</span> <span class='op'>&lt;</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'># no lower outliers</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>lofence</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>floor</a></span><span class='op'>(</span><span class='va'>qv</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>lofence</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>]</span>
  <span class='op'>}</span>
  <span class='kw'>if</span> <span class='op'>(</span><span class='va'>upfence</span> <span class='op'>&gt;</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span> <span class='op'>{</span> <span class='co'># no upper outliers</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>7</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>upfence</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/Round.html'>ceiling</a></span><span class='op'>(</span><span class='va'>qv</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>)</span>
  <span class='op'>}</span> <span class='kw'>else</span> <span class='op'>{</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>6</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>upfence</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>7</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>5</span><span class='op'>]</span>
  <span class='op'>}</span>
  <span class='va'>bb</span><span class='op'>[</span><span class='fl'>3</span><span class='op'>:</span><span class='fl'>5</span><span class='op'>]</span> <span class='op'>&lt;-</span> <span class='va'>qv</span><span class='op'>[</span><span class='fl'>2</span><span class='op'>:</span><span class='fl'>4</span><span class='op'>]</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>bb</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='co'># Extract variable as vector out of dataframe</span>
<span class='va'>get.var</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>vname</span>, <span class='va'>df</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='va'>df</span><span class='op'>[</span><span class='va'>vname</span><span class='op'>]</span> <span class='co'># %&gt;% sf::st_set_geometry(NULL)</span>
  <span class='va'>v</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span> <span class='co'># unname(v[,1])</span>
  <span class='kw'><a href='https://rdrr.io/r/base/function.html'>return</a></span><span class='op'>(</span><span class='va'>v</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='co'># Boxmap function</span>
<span class='va'>boxmap</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>vnam</span>, <span class='va'>df</span>, <span class='va'>mtitle</span>, <span class='va'>legtitle</span><span class='op'>=</span><span class='cn'>NA</span>, <span class='va'>mult</span><span class='op'>=</span><span class='fl'>1.5</span>, <span class='va'>palette</span><span class='op'>=</span><span class='st'>'-RdBu'</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='va'>df1</span> <span class='op'>&lt;-</span> <span class='fu'>drop_na</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span>
  <span class='va'>var</span> <span class='op'>&lt;-</span> <span class='fu'>get.var</span><span class='op'>(</span><span class='va'>vnam</span>,<span class='va'>df1</span><span class='op'>)</span>
  <span class='va'>bb</span> <span class='op'>&lt;-</span> <span class='fu'>boxbreaks</span><span class='op'>(</span><span class='va'>var</span><span class='op'>)</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>tm_fill</span><span class='op'>(</span><span class='va'>vnam</span>,
            title<span class='op'>=</span><span class='va'>legtitle</span>,
            breaks<span class='op'>=</span><span class='va'>bb</span>,
            palette<span class='op'>=</span><span class='st'>"Blues"</span>,
            labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Lower outlier"</span>, <span class='st'>"&lt; 25%"</span>, <span class='st'>"25% - 50%"</span>, <span class='st'>"50% - 75%"</span>,<span class='st'>"&gt; 75%"</span>, <span class='st'>"Upper outlier"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>lwd<span class='op'>=</span><span class='fl'>0.1</span>, alpha<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='va'>mtitle</span>,
            main.title.position <span class='op'>=</span> <span class='st'>'center'</span>,
            main.title.size <span class='op'>=</span> <span class='fl'>1.5</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span>,legend.title.size <span class='op'>=</span> <span class='fl'>1.20</span>, legend.text.size <span class='op'>=</span> <span class='fl'>1.10</span>, legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.10</span>, text.size <span class='op'>=</span> <span class='fl'>0.90</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>, labels.size <span class='op'>=</span> <span class='fl'>1.10</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
<span class='op'>}</span>


<span class='co'># Boxmap function with points overlayed on top of choropleth map</span>
<span class='va'>boxmap_pts</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>vnam</span>, <span class='va'>df</span>, <span class='va'>pointdf</span>, <span class='va'>mtitle</span>, <span class='va'>legtitle</span><span class='op'>=</span><span class='cn'>NA</span>, <span class='va'>mult</span><span class='op'>=</span><span class='fl'>1.5</span>, <span class='va'>palette</span><span class='op'>=</span><span class='st'>'-RdBu'</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>boxmap</span><span class='op'>(</span><span class='va'>vnam</span>, <span class='va'>df</span>, <span class='va'>mtitle</span>, legtitle<span class='op'>=</span><span class='va'>legtitle</span>, mult<span class='op'>=</span><span class='va'>mult</span>, palette<span class='op'>=</span><span class='va'>palette</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>pointdf</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'>tm_dots</span><span class='op'>(</span>col<span class='op'>=</span><span class='st'>"gray23"</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>We will now use the function using the previous constructed dataframe, Jakarta_Covid_Cases to display summary statistics.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_Cases_Boxmap</span> <span class='op'>&lt;-</span> <span class='fu'>boxmap</span><span class='op'>(</span><span class='st'>"Cases Per 10k Population"</span>, <span class='va'>Jakarta_Covid_Cases</span>, mtitle<span class='op'>=</span><span class='st'>"Boxmap of Jakarta Covid Cases, Mar 2020-July 2021"</span><span class='op'>)</span>
<span class='va'>Covid_Cases_Boxmap</span> 
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-63-1.png" width="1152" /></p>
</div>
<ul>
<li><p>The box map reveals that there are approximately more than 40 upper outliers (i.e. sub-district with extremely high COVID-19 cases per 10k population)</p></li>
<li><p>Upper outliers are disperse geographically throughout Jakarta though more prominent in Central Jakarta</p></li>
<li><p>To note, most upper outliers are closed to each others.</p></li>
<li><p>There is no lower outlier.</p></li>
</ul>
<h3 id="case-fatality-ratio-cfr">12.3 Case Fatality Ratio (CFR)</h3>
<p>Case Fatality Ratio (CFR) estimates the proportion of deaths among identified confirmed cases.To verify one of the earlier stated hypothesis that Covid-19 have low fatality rate, we will use the following formula:</p>
<p><span class="math display">\[ Case\ Fatality\ Rate\ = 
\frac{Total\ no\ of\ Covid-19\ Death\ at\ Sub-District\ 
Level}{Total\ Covid-19\ Cases\ of\ the\ Sub-District} *\ 100\]</span></p>
<p>The case fatality rate represents the proportion of cases that eventually die from a disease. Reliable CFRs that can be used to assess the deadliness of an outbreak and evaluate any implemented public health measures are generally obtained at the end of an outbreak, after all cases have been resolved (affected individuals either died or recovered). However, this calculation assumes that:</p>
<ul>
<li>The likelihood of detecting cases and deaths is consistent over the course of the outbreak.</li>
<li>All detected cases have resolved (that is, reported cases have either recovered or died).</li>
</ul>
<p>We will create a new dataframe called Merged_DF to calculate the CFR and we will only be selecting the relevant column namely, cases, sub-district and death.</p>
<p>The following code chunk will use left_join() of dplyr to join the geographical data (DKI_Jakarta) and attribute table (Merged_DF) using sub-district e.g.“Sub_District” as the common identifier.</p>
<p>Following which, it will be group by sub-district and we will calculate Case Fatality Rate using summarise function of dplyr.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Merged_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'>select</span><span class='op'>(</span><span class='st'>'Cases'</span>, <span class='st'>'Sub_District'</span>,<span class='st'>'Death'</span><span class='op'>)</span>

<span class='va'>Merged_DF</span><span class='op'>&lt;-</span> <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, <span class='va'>Merged_DF</span>, 
                      by<span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span> <span class='op'>=</span> <span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span> <span class='op'>(</span><span class='va'>Sub_District</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>`Case Fatality Rate` <span class='op'>=</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Death</span><span class='op'>)</span> <span class='op'>/</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Cases</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>*</span><span class='fl'>100</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Next, we will plot the result on the map using jenks classification method</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_mode</span><span class='op'>(</span><span class='st'>"plot"</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Merged_DF</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"Case Fatality Rate"</span>,n <span class='op'>=</span> <span class='fl'>5</span>, style<span class='op'>=</span><span class='st'>"jenks"</span>,
          legend.is.portrait <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>main.title <span class='op'>=</span> <span class='st'>"Case Fatality Ratio (CFR) of Jakarta (Mar 2020- July 2021) "</span>,
            main.title.position <span class='op'>=</span> <span class='st'>"center"</span>,
            main.title.size <span class='op'>=</span> <span class='fl'>0.75</span>,title.size <span class='op'>=</span> <span class='fl'>0.30</span>,legend.title.size <span class='op'>=</span> <span class='fl'>0.80</span>, 
            legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,
            legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span>,
            frame <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>1.5</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.10</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span><span class='op'>)</span> 
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-65-1.png" width="624" /></p>
</div>
<ul>
<li><p>From the result, there appears to be difference in case fatality rate across sub-district in Jakarta</p></li>
<li><p>In line with earlier observation, CFR appears to be generally higher in Central Jakarta region</p></li>
<li><p>Aforementioned in the introduction, the result of the CFR map is in line with the estimated 2% case fatality rate.</p></li>
</ul>
<h3 id="excess-risk-map">12.4 Excess Risk Map</h3>
<p>A commonly used notion in demography and public health analysis is the concept of a standardized mortality rate (SMR), sometimes also referred to as relative risk or excess risk. The idea is to compare the observed mortality rate to a national (or regional) standard. More specifically, the observed number of events is compared to the number of events that would be expected had a reference risk been applied.</p>
<p>In our example, all the COVID-19 deaths in the sub-district over sub-district total population size. Formally, this is expressed as:</p>
<p><span class="math display">\[SMR= \frac{Number \ of \ observed \ deaths}{Number\ of\ expected\ deaths}\]</span></p>
<p>which yields the expected number of events for each area i as:</p>
<p><span class="math display">\[E_{i}=π∗P_{i}\]</span></p>
<p>The relative risk then follows as the ratio of the observed number of events (e.g., Covid death) over the expected number:</p>
<p><span class="math display">\[SMR_{i} = \frac{O_{i}}{E_{i}}\]</span></p>
<p>We start by calculating the reference rate, which is just the sum of events over the sum of the population.</p>
<p>First, we set the filter to the most recent month which is July 2021.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span><span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2021-07-31"</span><span class='op'>)</span>


<span class='va'>sum_observed</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Death</span><span class='op'>)</span>
<span class='va'>sum_population</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/sum.html'>sum</a></span><span class='op'>(</span><span class='va'>DKI_Jakarta</span><span class='op'>$</span><span class='va'>Total_Population</span><span class='op'>)</span>
<span class='va'>p_i</span> <span class='op'>&lt;-</span> <span class='va'>sum_observed</span> <span class='op'>/</span> <span class='va'>sum_population</span>
</code></pre>
</div>
</div>
<p>Next we calculate the expected number of events for each sub-district based on the reference rate for the whole Jakarta and the population for each sub-district.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>E_i</span> <span class='op'>&lt;-</span> <span class='va'>p_i</span> <span class='op'>*</span> <span class='va'>DKI_Jakarta</span><span class='op'>$</span><span class='va'>Total_Population</span>
</code></pre>
</div>
</div>
<p>We will divide the actual count by the expected count to get the relative risk rate. This ratio will show us which sub-district have a higher than expected number of Covid-19 death, and which sub-district have a lower than expected count.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>smr</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span><span class='op'>$</span><span class='va'>Death</span> <span class='op'>/</span> <span class='va'>E_i</span>
</code></pre>
</div>
</div>
<p>Next, we will group by date and sub-district and do a left_join using common identifier ‘Sub-District’ and omit the na fields and convert into sf.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Covid_DF</span> <span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span> <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Date</span>, <span class='va'>Sub_District</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_smr</span><span class='op'>&lt;-</span> <span class='va'>Covid_DF</span> <span class='op'>%&gt;%</span>
  <span class='fu'>left_join</span><span class='op'>(</span><span class='va'>DKI_Jakarta</span>, by<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"Sub_District"</span><span class='op'>=</span><span class='st'>"Sub_District"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_smr</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/stats/na.fail.html'>na.omit</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_smr</span>,<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"smr"</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_smr</span><span class='op'>&lt;-</span> <span class='fu'>st_as_sf</span><span class='op'>(</span><span class='va'>Jakarta_Covid_smr</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_smr</span><span class='op'>&lt;-</span> <span class='va'>Jakarta_Covid_smr</span>  <span class='op'>%&gt;%</span> <span class='fu'>ungroup</span><span class='op'>(</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Afterwhich, we will plot the map using tmp_fill() with the variable ‘smr’</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>Jakarta_Covid_smr</span><span class='op'>)</span> <span class='op'>+</span>
     <span class='fu'>tm_fill</span><span class='op'>(</span><span class='st'>"smr"</span>,title<span class='op'>=</span><span class='st'>"Excess risk"</span>, breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='fl'>100</span>,<span class='fl'>.25</span>,<span class='fl'>.5</span>,<span class='fl'>1</span>,<span class='fl'>2</span>,<span class='fl'>4</span>,<span class='fl'>1000</span><span class='op'>)</span>,labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"&lt;.25"</span>, <span class='st'>".25 - .50"</span>, <span class='st'>".50 - 1.00"</span>,<span class='st'>"1.00 - 2.00"</span>, <span class='st'>"2.00 - 4.00"</span>, <span class='st'>"&gt; 4.00"</span> <span class='op'>)</span>, palette <span class='op'>=</span> <span class='st'>"OrRd"</span><span class='op'>)</span>  <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>legend.show <span class='op'>=</span> <span class='cn'>TRUE</span>, 
            main.title.size <span class='op'>=</span> <span class='fl'>1</span>,main.title <span class='op'>=</span> <span class='st'>"Excess Risk Rate In Jakarta Sub-District (July 2021)"</span>, legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.width <span class='op'>=</span> <span class='fl'>0.70</span>, legend.text.size <span class='op'>=</span> <span class='fl'>0.80</span>, legend.title.size <span class='op'>=</span> <span class='fl'>1.00</span>, legend.position <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"left"</span>, <span class='st'>"bottom"</span><span class='op'>)</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>0.9</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.09</span>,text.size <span class='op'>=</span> <span class='fl'>0.60</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>0.70</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-70-1.png" width="624" /></p>
</div>
<ul>
<li><p>In the excess risk map, pale pink sub-district s will indicate a risk lower than Jakarta average, or SMR&lt;1. Red sub-district indicate a risk higher than the Jakarta average, or SMR&gt;1.</p></li>
<li><p>From the excess risk map, we can observe that a few sub-district in Central Jakarta region has lower excess risk level (&lt;0.50) compared to other region. A possible explanation for this observation may be due to the fact that the 6 main COVID-19 specialized hospital are located in central Jakarta hence mortality rate is lower, though further statistical test need to be carried out.</p></li>
<li><p>Amongst all the sub-district in Jakarta, we can see that sub-district in North Jakarta appears to be experiencing higher excess risk of mostly &gt;2 compared to other region in Jakarta</p></li>
</ul>
<h2 id="localised-geospatial-statistic">13. Localised Geospatial Statistic</h2>
<h3 id="data-preparation-2">13.1 Data Preparation</h3>
<p>First, we will filter the time period of interest which are:</p>
<ul>
<li>March 2020</li>
<li>March 2021</li>
</ul>
<p>The time period is chosen based on 1 year after the onset of COVID-19 in Jakarta.</p>
<p>First, we will filter the data according to date - “2020-03-31” and “2021-03-31” and create a new dataframe name Jakarta_Covid_Cases_March20 and Jakarta_Covid_Cases_March21 respectively.</p>
<p>Next, data will be converted to the sp class to facilitate data analysis in this section.</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>Jakarta_Covid_Cases_March20</span> <span class='op'>&lt;-</span> <span class='va'>Jakarta_Covid_Cases</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2020-03-31"</span><span class='op'>)</span>

<span class='va'>Jakarta_Covid_Cases_March21</span> <span class='op'>&lt;-</span> <span class='va'>Jakarta_Covid_Cases</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/stats/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>Date</span> <span class='op'>==</span> <span class='st'>"2021-03-31"</span><span class='op'>)</span>


<span class='va'>Jakarta_Covid_Cases_March21_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21</span>, <span class='st'>'Spatial'</span><span class='op'>)</span>
<span class='va'>Jakarta_Covid_Cases_March20_sp</span> <span class='op'>&lt;-</span> <span class='fu'>as</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March20</span>, <span class='st'>'Spatial'</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h3 id="define-weight-matrix">13.2 Define Weight Matrix</h3>
<p>Before the analysis can be conducted, the weight matrix will first to have to defined for sub-district in Jakarta. The neighbourhood structure of sub-districts will be codified using contiguity weight matrices to express the spatial dependency between the sub-districts</p>
<h4 id="compute-rook-contiguity-weight-matrix">13.2.1 Compute rook contiguity weight matrix</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>JK_Covid</span> <span class='op'>&lt;-</span> <span class='fu'>poly2nb</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span>, queen<span class='op'>=</span><span class='cn'>FALSE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>JK_Covid</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Neighbour list object:
Number of regions: 261 
Number of nonzero links: 1364 
Percentage nonzero weights: 2.002319 
Average number of links: 5.226054 
Link number distribution:

 2  3  4  5  6  7  8  9 10 
 5 13 61 82 55 33  9  2  1 
5 least connected regions:
35 88 155 220 255 with 2 links
1 most connected region:
110 with 10 links</code></pre>
</div>
<ul>
<li>The most connected sub-district has 10 neighbours.</li>
<li>There are 5 sub-districts which are the least connected with only 2 neighbours.</li>
</ul>
<h4 id="compute-queen-contiguity-weight-matrix">13.2.2 Compute queen contiguity weight matrix</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>JK_queen</span> <span class='op'>&lt;-</span> <span class='fu'>poly2nb</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span>, queen<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>JK_queen</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>Neighbour list object:
Number of regions: 261 
Number of nonzero links: 1488 
Percentage nonzero weights: 2.184348 
Average number of links: 5.701149 
Link number distribution:

 2  3  4  5  6  7  8  9 11 
 5 11 45 57 68 40 25  9  1 
5 least connected regions:
35 88 155 220 255 with 2 links
1 most connected region:
110 with 11 links</code></pre>
</div>
<ul>
<li>The most connected sub-district has 11 neighbours.</li>
<li>There are 5 sub-district which are the least connected with only 2 neighbour which is similar to rook contiguity weight matrix.</li>
</ul>
<h4 id="compute-number-of-regions-with-no-neighbours">13.2.3 Compute number of regions with no neighbours</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'Rook contiguity: There are '</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>card</span><span class='op'>(</span><span class='va'>JK_Covid</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>' sub-district(s) with no neighbours.'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Rook contiguity: There are 0 sub-district(s) with no neighbours.&quot;</code></pre>
</div>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste0</a></span><span class='op'>(</span><span class='st'>'Queen contiguity: There are '</span>, <span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/which.html'>which</a></span><span class='op'>(</span><span class='fu'>card</span><span class='op'>(</span><span class='va'>JK_queen</span><span class='op'>)</span><span class='op'>==</span><span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>, <span class='st'>' sub-district(s) with no neighbours.'</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>[1] &quot;Queen contiguity: There are 0 sub-district(s) with no neighbours.&quot;</code></pre>
</div>
<ul>
<li>All sub-district had at least one neighbour.</li>
</ul>
<h4 id="distribution-of-the-number-of-neighbours-for-sub-district">13.2.4 Distribution of the number of neighbours for sub-district</h4>
<ul>
<li><p>First we will create data frame using neighbour list for queen contiguity weight matrix.</p></li>
<li><p>For each number of neighbour, count the number of sub-district having that number of neighbouring sub-district</p></li>
<li><p>Next, we will create bar chart visualising the distribution of number of neighbours usin ggplot</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>JK_DF</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span><span class='op'>(</span><span class='st'>'Neighbours'</span> <span class='op'>=</span> <span class='fu'>card</span><span class='op'>(</span><span class='va'>JK_queen</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>group_by</span><span class='op'>(</span><span class='va'>Neighbours</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarise</a></span><span class='op'>(</span>Count <span class='op'>=</span> <span class='fu'>n</span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>JK_DF</span><span class='op'>[</span><span class='fu'><a href='https://rdrr.io/r/base/NA.html'>is.na</a></span><span class='op'>(</span><span class='va'>JK_DF</span><span class='op'>)</span><span class='op'>]</span> <span class='op'>=</span> <span class='fl'>0</span>

<span class='fu'>ggplot</span><span class='op'>(</span><span class='va'>JK_DF</span>, <span class='fu'>aes</span><span class='op'>(</span>x <span class='op'>=</span> <span class='va'>Neighbours</span>, y <span class='op'>=</span> <span class='va'>Count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>geom_col</span><span class='op'>(</span>fill <span class='op'>=</span> <span class='st'>'slategray3'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>labs</span><span class='op'>(</span>title <span class='op'>=</span> <span class='st'>'Distribution of Number of Neighbours for Sub-district'</span>,
       x <span class='op'>=</span> <span class='st'>'Number of Neighbours'</span>,
       y <span class='op'>=</span> <span class='st'>'Number of Sub-district'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme_minimal</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>theme</span><span class='op'>(</span>axis.title.y <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>15</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
        axis.title.x <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>10</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>0</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span>,
        plot.title <span class='op'>=</span> <span class='fu'>element_text</span><span class='op'>(</span>margin <span class='op'>=</span> <span class='fu'>margin</span><span class='op'>(</span>t <span class='op'>=</span> <span class='fl'>0</span>, r <span class='op'>=</span> <span class='fl'>0</span>, b <span class='op'>=</span> <span class='fl'>20</span>, l <span class='op'>=</span> <span class='fl'>0</span><span class='op'>)</span><span class='op'>)</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-76-1.png" width="624" /></p>
</div>
<ul>
<li>Although all sub-district had at least one neighbour, majority of the sub-district only have small number of neighbours (6 and below) which might not lead to stable and statistically significant results.</li>
</ul>
<h4 id="plot-of-queen-contiguity-neighbour-map">13.2.5 Plot of Queen contiguity neighbour map</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span>, border<span class='op'>=</span><span class='st'>"lightgrey"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>JK_queen</span>, <span class='fu'>coordinates</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span><span class='op'>)</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, cex <span class='op'>=</span> <span class='fl'>0.6</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>, col<span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-77-1.png" width="624" /></p>
</div>
<ul>
<li><p>From the plot, the use of contiguity based methods lead to edge effects, where sub-district at the edge e,g Northern Jakarta region only have a small number of neighbours.</p></li>
<li><p>Furthermore, it must be noted from the plot that large sub-district surrounded by smaller sub-districts will have far greater number of neighbours than its neighbouring zones</p></li>
<li><p>Considering the context of the analysis, COVID-19 is spread through contact and respiratory droplets. Hence for the sub-district in this analysis, being located at a certain distance from one another is more important than being located on which side of the boundary.</p></li>
<li><p>Thus, we will look into distance-based methods for computing the weight matrix.</p></li>
</ul>
<h4 id="distance-based-weight-matrices">13.3 Distance-based weight matrices</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>coords</span> <span class='op'>&lt;-</span> <span class='fu'>coordinates</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March20_sp</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<h5 id="adaptive-distance">13.3.1 Adaptive distance</h5>
<p>As COVID-19 rates were observed to be slightly skewed in earlier analysis, sub-district should be evaluated in the context of at approximately neighbours for results to be stable.</p>
<p>Noting that with the selection of more neighbours (higher k), spatial patterns become increasingly homogenised, 9 nearest neighbours are chosen for the computation of the adaptive distance matrix.</p>
<p>The following code chunk will compute adaptive distance matrix of 9 nearest neighbours</p>
<h6 id="compute-adaptive-distance-matrix-of-9-nearest-neighbours">13.3.1.1 Compute adaptive distance matrix of 9 nearest neighbours</h6>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>wm_knn9</span> <span class='op'>&lt;-</span> <span class='fu'>knn2nb</span><span class='op'>(</span><span class='fu'>knearneigh</span><span class='op'>(</span><span class='va'>coords</span>, k<span class='op'>=</span><span class='fl'>9</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>wm_knn9</span>
</code></pre>
</div>
<pre><code>Neighbour list object:
Number of regions: 261 
Number of nonzero links: 2349 
Percentage nonzero weights: 3.448276 
Average number of links: 9 
Non-symmetric neighbours list</code></pre>
</div>
<ul>
<li>Each sub-district has 9 neighbours, there are no sub-district with no neighbours.</li>
</ul>
<h6 id="summary-statistics-of-neighbour-distances-with-9-nearest-neighbours">13.3.1.2 Summary statistics of neighbour distances with 9 nearest neighbours</h6>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>k9dists</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'>nbdists</span><span class='op'>(</span><span class='va'>wm_knn9</span>, <span class='va'>coords</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>k9dists</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  442.6  1513.3  2058.6  2317.7  2862.6  8800.7 </code></pre>
</div>
<ul>
<li>Using 9 nearest neighbours, the maximum distance between neighbours is 8800m which is a reasonable distance for citizens to engage in social interaction with one another which may then lead to the spread of COVID-19.</li>
</ul>
<h6 id="adaptive-distance-neighbour-map">13.3.1.3 Adaptive distance neighbour map</h6>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March20_sp</span>, border<span class='op'>=</span><span class='st'>"lightgrey"</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>wm_knn9</span>, <span class='va'>coords</span>, pch <span class='op'>=</span> <span class='fl'>19</span>, cex <span class='op'>=</span> <span class='fl'>0.6</span>, add <span class='op'>=</span> <span class='cn'>TRUE</span>, col<span class='op'>=</span> <span class='st'>"red"</span><span class='op'>)</span>
</code></pre>
</div>
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-81-1.png" width="624" /></p>
</div>
<h3 id="local-morans-i">13.3 Local Moran’s I</h3>
<p>Local Moran’s I (a local spatial autocorrelation indicator - LISA) will be utilised to detect spatial clusters of sub-district with high or low COVID-19 cases per 10k population rates, and detect outliers. The analysis will be conducted from Mar 2020 to Mar 2021 to better analyse and understand spatial clusters and outliers across time.</p>
<p>Interpretation of local Moran’s I values</p>
<ul>
<li><p>Ii&lt;0: indicates negative spatial local autocorrelation, suggesting a combination of dissimilar values (high values surrounded by low values, or low values surrounded by high values)</p></li>
<li><p>Ii&gt;0: indicates positive spatial local autocorrelation, suggesting a grouping of similar values (that are higher or lower than average)</p></li>
</ul>
<h4 id="compute-row-standardised-weight-matrix">13.3.1 Compute row-standardised weight matrix</h4>
<p>The sum of weights of its neighbours for a particular sub-district is equal to 1.</p>
<p>The row-standardised weight matrix will be constructed as follow:</p>
<ul>
<li><p>Weights are assigned to each neighbouring sub-district and standardised.</p></li>
<li><p>In a row-standardised weight matrix: For a particular sub-district, each neighbouring sub-district is assigned a fraction of 1 / Total number of neighbours. Each weight can thus be interpreted as the fraction of spatial influence on the particular sub-district that is ascribable to the neighbouring sub-district.</p></li>
<li><p>With weights assigned to each neighbour, in the computation of average neighbouring COVID-19 case per 10k population rate, each neighbour’s COVID-19 rate will be multiplied by its weight (1 / Total number of neighbours), then tallied.</p></li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>rswm_knn9</span> <span class='op'>&lt;-</span> <span class='fu'>nb2listw</span><span class='op'>(</span><span class='va'>wm_knn9</span>, style <span class='op'>=</span> <span class='st'>'W'</span><span class='op'>)</span>
<span class='va'>rswm_knn9</span>
</code></pre>
</div>
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 261 
Number of nonzero links: 2349 
Percentage nonzero weights: 3.448276 
Average number of links: 9 
Non-symmetric neighbours list

Weights style: W 
Weights constants summary:
    n    nn  S0       S1       S2
W 261 68121 261 52.60494 1061.012</code></pre>
</div>
<h4 id="compute-local-morans-i-of-covid-19-case-per-10k-population-rate-at-the-sub-district-level-for-mar-2020-and-mar-2021">13.3.2 Compute Local Moran’s I of COVID-19 Case Per 10k Population rate at the sub-district level for Mar 2020 and Mar 2021</h4>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>localmoran_Mar20</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March20_sp</span><span class='op'>$</span><span class='va'>Cases.Per.10k.Population</span>, <span class='va'>rswm_knn9</span><span class='op'>)</span>
<span class='va'>localmoran_Mar21</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran</span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span><span class='op'>$</span><span class='va'>Cases.Per.10k.Population</span>, <span class='va'>rswm_knn9</span><span class='op'>)</span>

<span class='va'>JKT_localmoran_Mar20</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March20_sp</span>, <span class='va'>localmoran_Mar20</span><span class='op'>)</span>
<span class='va'>JKT_localmoran_Mar21</span>  <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span><span class='op'>(</span><span class='va'>Jakarta_Covid_Cases_March21_sp</span> , <span class='va'>localmoran_Mar21</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<p>Here is the coefficients for Local Moran’s I for Mar 2020 for the first 5 sub-district</p>
<ul>
<li>Ii: local Moran statistic</li>
<li>E.Ii: expectation of local Moran statistic</li>
<li>Var.Ii: variance of local Moran statistic</li>
<li>Z.Ii: standard deviate of local Moran statistic</li>
<li>Pr(): p-value of local Moran statistic</li>
</ul>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar20</span>, <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 5 
extent      : -3630494, -3612584, 669727, 698731.4  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=0 +lon_0=139.5 +k=0.9999 +x_0=200000 +y_0=1500000 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 16
names       : Sub_District,  Date, Cases.Per.10k.Population, Object_ID, Village_Code,    Village,     ID,    Province,          City, District, Total_Population,                  Ii,                 E.Ii,             Var.Ii,              Z.Ii, ... 
min values  :        ANCOL, 18352,                        0,     25455,   3172051003,      ANCOL, 317205, DKI JAKARTA, JAKARTA BARAT, CIPAYUNG,            11695, -0.0336105625690283, -0.00384615384615385, 0.0204054783376411, -0.20836456788388, ... 
max values  :   BAMBU APUS, 18352,         1.71013253527148,     25642,   3175101006, BAMBU APUS, 317510, DKI JAKARTA, JAKARTA UTARA,  TAMBORA,            36428,  0.0505499406939711, -0.00384615384615385, 0.0204054783376411, 0.380797711755426, ... </code></pre>
</div>
<p>Here is the coefficients for Local Moran’s I for Mar 2021 for the first 5 sub-district</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar21</span>, <span class='fl'>5</span><span class='op'>)</span>
</code></pre>
</div>
<pre><code>class       : SpatialPolygonsDataFrame 
features    : 5 
extent      : -3630494, -3612584, 669727, 698731.4  (xmin, xmax, ymin, ymax)
crs         : +proj=tmerc +lat_0=0 +lon_0=139.5 +k=0.9999 +x_0=200000 +y_0=1500000 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs 
variables   : 16
names       : Sub_District,  Date, Cases.Per.10k.Population, Object_ID, Village_Code,    Village,     ID,    Province,          City, District, Total_Population,                  Ii,                 E.Ii,             Var.Ii,                Z.Ii, ... 
min values  :        ANCOL, 18717,         195.728560448007,     25455,   3172051003,      ANCOL, 317205, DKI JAKARTA, JAKARTA BARAT, CIPAYUNG,            11695, -0.0117370782046478, -0.00384615384615385, 0.0890141328968958, -0.0264483386754424, ... 
max values  :   BAMBU APUS, 18717,         325.423302070876,     25642,   3175101006, BAMBU APUS, 317510, DKI JAKARTA, JAKARTA UTARA,  TAMBORA,            36428,   0.584846424622372, -0.00384615384615385, 0.0890141328968958,    1.97314534821199, ... </code></pre>
</div>
<h4 id="map-local-morans-i">13.3.3 Map Local Moran’s I</h4>
<p>To enable a better understanding of the calculated scores, local Moran’s I scores for Mar 2020 and Mar 2021 are visualised on a choropleth map.</p>
<p>Here is the function for constructing the choropleth map and we will be using tmap_fill with the column Ii:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>localmoran_map</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"Ii"</span>, 
          style <span class='op'>=</span> <span class='st'>"pretty"</span>,
          palette <span class='op'>=</span> <span class='st'>"RdBu"</span>,
          title <span class='op'>=</span> <span class='st'>'Local Moran \nStatistics'</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>panel.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>'Local Moran\'s I,%s'</span>, <span class='va'>Date</span><span class='op'>)</span>,
            panel.label.color <span class='op'>=</span> <span class='st'>'gray12'</span>,,legend.title.size <span class='op'>=</span> <span class='fl'>2.75</span>, legend.text.size <span class='op'>=</span> <span class='fl'>2.55</span>, title.size<span class='op'>=</span><span class='fl'>3</span>, panel.label.size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.15</span>,text.size <span class='op'>=</span> <span class='fl'>2.30</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>, labels.size <span class='op'>=</span> <span class='fl'>1.50</span><span class='op'>)</span> 
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Plotting the map and arranging the map using tmap_arrange()</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>moranplot_13</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran_map</span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar20</span>, <span class='st'>"Mar 2020"</span><span class='op'>)</span>
<span class='va'>moranplot_32</span> <span class='op'>&lt;-</span> <span class='fu'>localmoran_map</span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar21</span>, <span class='st'>"Mar 2021"</span><span class='op'>)</span>
<span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>moranplot_13</span>, <span class='va'>moranplot_32</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-88-1.png" width="1920" /></p>
</div>
<ul>
<li>Blue areas (positive local Moran’s I) indicate positive spatial local autocorrelation</li>
<li>Red areas (negative local Moran’s I) indicate negative spatial local autocorrelation.</li>
<li>The choropleth local Moran’s I plot both positive and negative local Moran’s I values during the study period</li>
</ul>
<p>We will now consider the local Moran statistics with its corresponding p-values, to interpret if the values have statistical significance. As such, local Moran’s I values and the corresponding p-values will be visualised spatially side-by-side to understand sub-district which have local Moran’s I values that are statistically significant.</p>
<p>The following code chunk is a function to construct p-value map:</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='va'>pvalue_map</span> <span class='op'>&lt;-</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>Date</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'>tm_shape</span><span class='op'>(</span><span class='va'>df</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_fill</span><span class='op'>(</span>col <span class='op'>=</span> <span class='st'>"Pr.z...0."</span>, 
          breaks<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='op'>-</span><span class='cn'>Inf</span>, <span class='fl'>0.001</span>, <span class='fl'>0.01</span>, <span class='fl'>0.05</span>, <span class='fl'>0.1</span>, <span class='cn'>Inf</span><span class='op'>)</span>,
          palette <span class='op'>=</span> <span class='st'>"-Blues"</span>,
          title <span class='op'>=</span> <span class='st'>'P-values'</span>, title.size<span class='op'>=</span><span class='fl'>2.8</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_compass</span><span class='op'>(</span>type<span class='op'>=</span><span class='st'>"4star"</span>, size <span class='op'>=</span> <span class='fl'>4</span><span class='op'>)</span> <span class='op'>+</span> 
  <span class='fu'>tm_scale_bar</span><span class='op'>(</span>width <span class='op'>=</span> <span class='fl'>0.15</span>,text.size <span class='op'>=</span> <span class='fl'>2.30</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_grid</span><span class='op'>(</span>lwd <span class='op'>=</span> <span class='fl'>0.1</span>, alpha <span class='op'>=</span> <span class='fl'>0.2</span>,labels.size<span class='op'>=</span><span class='fl'>1.50</span><span class='op'>)</span><span class='op'>+</span>
  <span class='fu'>tm_borders</span><span class='op'>(</span>alpha <span class='op'>=</span> <span class='fl'>0.5</span><span class='op'>)</span> <span class='op'>+</span>
  <span class='fu'>tm_layout</span><span class='op'>(</span>panel.labels <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/sprintf.html'>sprintf</a></span><span class='op'>(</span><span class='st'>'Local Moran\'s I p-values,%s'</span>, <span class='va'>Date</span><span class='op'>)</span>,
            panel.label.color <span class='op'>=</span> <span class='st'>'gray12'</span>, legend.outside <span class='op'>=</span> <span class='cn'>FALSE</span>,legend.title.size <span class='op'>=</span> <span class='fl'>2.75</span>, legend.text.size <span class='op'>=</span> <span class='fl'>2.55</span>, panel.label.size <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span>
<span class='op'>}</span>
</code></pre>
</div>
</div>
<p>Plotting the map</p>
<div class="layout-chunk" data-layout="l-body">
<div class="sourceCode">
<pre class="sourceCode r"><code class="sourceCode r"><span class='fu'>tmap_arrange</span><span class='op'>(</span><span class='va'>moranplot_13</span>, <span class='fu'>pvalue_map</span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar20</span>, <span class='st'>"March 2020"</span><span class='op'>)</span>,
             <span class='va'>moranplot_32</span>, <span class='fu'>pvalue_map</span><span class='op'>(</span><span class='va'>JKT_localmoran_Mar21</span>, <span class='st'>"March 2021"</span><span class='op'>)</span>,
             ncol<span class='op'>=</span><span class='fl'>2</span><span class='op'>)</span>
</code></pre>
</div>
</div>
<div class="layout-chunk" data-layout="l-body">
<p><img src="take-home-exercise-1_files/figure-html5/unnamed-chunk-91-1.png" width="1920" /></p>
</div>
<p><em>March 2020</em></p>
<ul>
<li><p>Relatively high and positive local Moran’s I values as indicated by darker blue areas on the local Moran’s I plot March 2021 around Karet Semmangi</p></li>
<li><p>These values are statistically significant at 99.9% confidence level, with p-values of less than 0.001 indicated by the corresponding areas that are in darkest shade of blue at the p-value plot.</p></li>
<li><p>From the result, we can onserve that there is significant and positive local autocorrelation for COVID-19 case per 10k population at these bordering sub-district, suggesting a grouping of sub-district with COVID-19 rates that are higher than average for these bordering sub-districts during March 2020.</p></li>
</ul>
<p><em>March 2021</em></p>
<p>One year after onset of COVID-19, sub-district with positive and relatively higher Moran’s I values are statistically significant at 99.9% confidence level (p-value less than 0.001).</p>
<p>There is therefore significant and positive local autocorrelation for COVID-19 cases per 10k population rate at sub-district in March 2021, suggesting that this group of sub-district are a cluster for COVID-19 at March 2021, with COVID-19 rates that are higher than average.</p>
<h2 id="conclusion">14. Conclusion</h2>
<p>Through the different analysis, the following observations were made:</p>
<p><em>Spatial-temporal patterns of Covid-19 Cases and how they change over time.</em></p>
<ul>
<li><p>COVID-19 cases seem to spread outwards to the neighbouring sub-district with time as seen from the time-series choropleth map of Covid-19 rate</p></li>
<li><p>Significant and positive local autocorrelation for COVID-19 case per 10k population at bordering sub-district, suggesting a grouping of sub-district with COVID-19 rates that are higher than average for bordering sub-districts during March 2020.</p></li>
<li><p>Significant and positive local autocorrelation for COVID-19 cases per 10k population rate at sub-district in March 2021, suggesting that this group of sub-district are a cluster for COVID-19 at March 2021, with COVID-19 rates that are higher than average.</p></li>
</ul>
<p><em>Sub-districts with relatively higher number of confirmed cases</em></p>
<ul>
<li><p>In descending order of Covid rate per 10k population: Gambir, Senayan and Gunung were found to be the sub-district most affected by COVID-19</p></li>
<li><p>Through our Standardized Mortality Rate geospatial analysis, sub-district in North Jakarta appears to be experiencing higher excess risk of mostly &gt;2 compared to other region in Jakarta which may serve as a warning for local public health authority</p></li>
</ul>
<h2 id="references">15. References</h2>
<ul>
<li><p><a href="https://spatialanalysis.github.io/lab_tutorials/Rate_mapping.html#spatially-extensive-and-intensive-variables">Standardized Mortality Rate (SMR)</a></p></li>
<li><p><a href="https://corona.jakarta.go.id/en/artikel/linimasa-kebijakan-penanganan-pandemi-covid-19-di-jakarta">Jakarta Covid-19 Timeline</a></p></li>
<li><p><a href="https://www.straitstimes.com/singapore/how-covid-19-led-to-spores-clusters-airborne-droplet-or-surface-transmission">Transmission Method of Covid-19</a></p></li>
<li><p><a href="https://rpubs.com/xiaorongw/IS415_Take-home_Ex02">Past Covid-19 Analysis</a></p></li>
<li><p><a href="https://www.who.int/news-room/commentaries/detail/estimating-mortality-from-covid-19">Case Mortality Rate</a></p></li>
<li><p><a href="https://indonesien.ahk.de/infothek/news/news-details/covid-19-developments-in-indonesia">Delta Variant in Jakarta</a></p></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
